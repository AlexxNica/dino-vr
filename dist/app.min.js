"use strict";function randomInt(t,e){return Math.floor(Math.random()*(e-t+1))+t}function random(t,e){return Math.random()*(e-t+1)+t}function getTimeStamp(){return IS_IOS?(new Date).getTime():performance.now()}function vibrate(t){IS_MOBILE&&window.navigator.vibrate&&window.navigator.vibrate(t)}var canvas=document.createElement("canvas"),context=canvas.getContext("webgl2");if(null===context)throw new Error("Couldn't get a WebGL2 context");var gl=context;canvas.width=window.innerWidth*devicePixelRatio,canvas.height=window.innerHeight*devicePixelRatio,canvas.style.width=window.innerWidth+"px",canvas.style.height=window.innerHeight+"px",document.body.appendChild(canvas);for(var classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},createClass=(function(){function t(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,a,r){return a&&t(e.prototype,a),r&&t(e,r),e}}()),defineProperty=(function(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}),get=(function t(e,a,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,a);if(void 0===n){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,a,r)}if("value"in n)return n.value;var o=n.get;if(void 0!==o)return o.call(r)}),inherits=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},possibleConstructorReturn=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},toConsumableArray=function(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)},Geometry=function(){function t(e,a,r){classCallCheck(this,t),this.vaoId=gl.createVertexArray(),this.vertexCount=e.length,gl.bindVertexArray(this.vaoId),this.bindIndicesBuffer(e),this.bindAttributeBuffer(0,3,a),this.bindAttributeBuffer(1,2,r),gl.bindVertexArray(null)}return createClass(t,[{key:"bind",value:function(){gl.bindVertexArray(this.vaoId),gl.enableVertexAttribArray(0),gl.enableVertexAttribArray(1)}},{key:"unbind",value:function(){gl.bindVertexArray(null),gl.disableVertexAttribArray(0),gl.disableVertexAttribArray(1)}},{key:"bindAttributeBuffer",value:function(t,e,a){var r=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,r),gl.bufferData(gl.ARRAY_BUFFER,a,gl.STATIC_DRAW),gl.vertexAttribPointer(t,e,gl.FLOAT,!1,0,0),gl.bindBuffer(gl.ARRAY_BUFFER,null)}},{key:"bindIndicesBuffer",value:function(t){var e=gl.createBuffer();gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,e),gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,t,gl.STATIC_DRAW)}}]),t}(),quadPositions=new Float32Array([0,0,0,0,1,0,1,1,0,1,0,0]),quadUVs=new Float32Array([0,1,0,0,1,0,1,1]),quadIndex=new Uint16Array([0,1,2,0,2,3]),quad=new Geometry(quadIndex,quadPositions,quadUVs),ribbonSegments=40,ribbonInnerRadius=7,ribbonOuterRadius=12,ribbonPositions=new Float32Array(2*(ribbonSegments+1)*3),ribbonUVs=new Float32Array(2*(ribbonSegments+1)*2),ribbonIndex=new Uint16Array(2*ribbonSegments*3),i=0;i<ribbonSegments;i++){var angle=-2*Math.PI*(i/ribbonSegments);ribbonPositions[6*i+0]=Math.sin(angle)*ribbonInnerRadius,ribbonPositions[6*i+1]=0,ribbonPositions[6*i+2]=Math.cos(angle)*ribbonInnerRadius,ribbonPositions[6*i+3]=Math.sin(angle)*ribbonOuterRadius,ribbonPositions[6*i+4]=0,ribbonPositions[6*i+5]=Math.cos(angle)*ribbonOuterRadius,ribbonUVs[4*i+0]=i/ribbonSegments,ribbonUVs[4*i+1]=1,ribbonUVs[4*i+2]=i/ribbonSegments,ribbonUVs[4*i+3]=0,ribbonIndex[6*i+0]=2*i+0,ribbonIndex[6*i+1]=2*i+1,ribbonIndex[6*i+2]=2*i+2,ribbonIndex[6*i+3]=2*i+1,ribbonIndex[6*i+4]=2*i+3,ribbonIndex[6*i+5]=2*i+2}ribbonPositions[6*ribbonSegments+0]=0,ribbonPositions[6*ribbonSegments+1]=0,ribbonPositions[6*ribbonSegments+2]=ribbonInnerRadius,ribbonPositions[6*ribbonSegments+3]=0,ribbonPositions[6*ribbonSegments+4]=0,ribbonPositions[6*ribbonSegments+5]=ribbonOuterRadius,ribbonUVs[4*ribbonSegments+0]=1,ribbonUVs[4*ribbonSegments+1]=1,ribbonUVs[4*ribbonSegments+2]=1,ribbonUVs[4*ribbonSegments+3]=0;var ribbon=new Geometry(ribbonIndex,ribbonPositions,ribbonUVs),commonjsGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},glMatrix$2={};glMatrix$2.EPSILON=1e-6,glMatrix$2.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,glMatrix$2.RANDOM=Math.random,glMatrix$2.ENABLE_SIMD=!1,glMatrix$2.SIMD_AVAILABLE=glMatrix$2.ARRAY_TYPE===Float32Array&&"SIMD"in commonjsGlobal,glMatrix$2.USE_SIMD=glMatrix$2.ENABLE_SIMD&&glMatrix$2.SIMD_AVAILABLE,glMatrix$2.setMatrixArrayType=function(t){glMatrix$2.ARRAY_TYPE=t};var degree=Math.PI/180;glMatrix$2.toRadian=function(t){return t*degree},glMatrix$2.equals=function(t,e){return Math.abs(t-e)<=glMatrix$2.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))};var common=glMatrix$2,glMatrix$5=common,mat3$1={};mat3$1.create=function(){var t=new glMatrix$5.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},mat3$1.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},mat3$1.clone=function(t){var e=new glMatrix$5.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},mat3$1.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},mat3$1.fromValues=function(t,e,a,r,n,i,o,s,l){var u=new glMatrix$5.ARRAY_TYPE(9);return u[0]=t,u[1]=e,u[2]=a,u[3]=r,u[4]=n,u[5]=i,u[6]=o,u[7]=s,u[8]=l,u},mat3$1.set=function(t,e,a,r,n,i,o,s,l,u){return t[0]=e,t[1]=a,t[2]=r,t[3]=n,t[4]=i,t[5]=o,t[6]=s,t[7]=l,t[8]=u,t},mat3$1.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},mat3$1.transpose=function(t,e){if(t===e){var a=e[1],r=e[2],n=e[5];t[1]=e[3],t[2]=e[6],t[3]=a,t[5]=e[7],t[6]=r,t[7]=n}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},mat3$1.invert=function(t,e){var a=e[0],r=e[1],n=e[2],i=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=c*o-s*u,M=-c*i+s*l,m=u*i-o*l,f=a*h+r*M+n*m;return f?(f=1/f,t[0]=h*f,t[1]=(-c*r+n*u)*f,t[2]=(s*r-n*o)*f,t[3]=M*f,t[4]=(c*a-n*l)*f,t[5]=(-s*a+n*i)*f,t[6]=m*f,t[7]=(-u*a+r*l)*f,t[8]=(o*a-r*i)*f,t):null},mat3$1.adjoint=function(t,e){var a=e[0],r=e[1],n=e[2],i=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8];return t[0]=o*c-s*u,t[1]=n*u-r*c,t[2]=r*s-n*o,t[3]=s*l-i*c,t[4]=a*c-n*l,t[5]=n*i-a*s,t[6]=i*u-o*l,t[7]=r*l-a*u,t[8]=a*o-r*i,t},mat3$1.determinant=function(t){var e=t[0],a=t[1],r=t[2],n=t[3],i=t[4],o=t[5],s=t[6],l=t[7],u=t[8];return e*(u*i-o*l)+a*(-u*n+o*s)+r*(l*n-i*s)},mat3$1.multiply=function(t,e,a){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],M=a[0],m=a[1],f=a[2],S=a[3],d=a[4],v=a[5],I=a[6],x=a[7],D=a[8];return t[0]=M*r+m*o+f*u,t[1]=M*n+m*s+f*c,t[2]=M*i+m*l+f*h,t[3]=S*r+d*o+v*u,t[4]=S*n+d*s+v*c,t[5]=S*i+d*l+v*h,t[6]=I*r+x*o+D*u,t[7]=I*n+x*s+D*c,t[8]=I*i+x*l+D*h,t},mat3$1.mul=mat3$1.multiply,mat3$1.translate=function(t,e,a){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],M=a[0],m=a[1];return t[0]=r,t[1]=n,t[2]=i,t[3]=o,t[4]=s,t[5]=l,t[6]=M*r+m*o+u,t[7]=M*n+m*s+c,t[8]=M*i+m*l+h,t},mat3$1.rotate=function(t,e,a){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],M=Math.sin(a),m=Math.cos(a);return t[0]=m*r+M*o,t[1]=m*n+M*s,t[2]=m*i+M*l,t[3]=m*o-M*r,t[4]=m*s-M*n,t[5]=m*l-M*i,t[6]=u,t[7]=c,t[8]=h,t},mat3$1.scale=function(t,e,a){var r=a[0],n=a[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},mat3$1.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},mat3$1.fromRotation=function(t,e){var a=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=a,t[2]=0,t[3]=-a,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},mat3$1.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},mat3$1.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},mat3$1.fromQuat=function(t,e){var a=e[0],r=e[1],n=e[2],i=e[3],o=a+a,s=r+r,l=n+n,u=a*o,c=r*o,h=r*s,M=n*o,m=n*s,f=n*l,S=i*o,d=i*s,v=i*l;return t[0]=1-h-f,t[3]=c-v,t[6]=M+d,t[1]=c+v,t[4]=1-u-f,t[7]=m-S,t[2]=M-d,t[5]=m+S,t[8]=1-u-h,t},mat3$1.normalFromMat4=function(t,e){var a=e[0],r=e[1],n=e[2],i=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],M=e[10],m=e[11],f=e[12],S=e[13],d=e[14],v=e[15],I=a*s-r*o,x=a*l-n*o,D=a*u-i*o,g=r*l-n*s,$=r*u-i*s,E=n*u-i*l,p=c*S-h*f,T=c*d-M*f,F=c*v-m*f,b=h*d-M*S,_=h*v-m*S,P=M*v-m*d,A=I*P-x*_+D*b+g*F-$*T+E*p;return A?(A=1/A,t[0]=(s*P-l*_+u*b)*A,t[1]=(l*F-o*P-u*T)*A,t[2]=(o*_-s*F+u*p)*A,t[3]=(n*_-r*P-i*b)*A,t[4]=(a*P-n*F+i*T)*A,t[5]=(r*F-a*_-i*p)*A,t[6]=(S*E-d*$+v*g)*A,t[7]=(d*D-f*E-v*x)*A,t[8]=(f*$-S*D+v*I)*A,t):null},mat3$1.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},mat3$1.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},mat3$1.add=function(t,e,a){return t[0]=e[0]+a[0],t[1]=e[1]+a[1],t[2]=e[2]+a[2],t[3]=e[3]+a[3],t[4]=e[4]+a[4],t[5]=e[5]+a[5],t[6]=e[6]+a[6],t[7]=e[7]+a[7],t[8]=e[8]+a[8],t},mat3$1.subtract=function(t,e,a){return t[0]=e[0]-a[0],t[1]=e[1]-a[1],t[2]=e[2]-a[2],t[3]=e[3]-a[3],t[4]=e[4]-a[4],t[5]=e[5]-a[5],t[6]=e[6]-a[6],t[7]=e[7]-a[7],t[8]=e[8]-a[8],t},mat3$1.sub=mat3$1.subtract,mat3$1.multiplyScalar=function(t,e,a){return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*a,t},mat3$1.multiplyScalarAndAdd=function(t,e,a,r){return t[0]=e[0]+a[0]*r,t[1]=e[1]+a[1]*r,t[2]=e[2]+a[2]*r,t[3]=e[3]+a[3]*r,t[4]=e[4]+a[4]*r,t[5]=e[5]+a[5]*r,t[6]=e[6]+a[6]*r,t[7]=e[7]+a[7]*r,t[8]=e[8]+a[8]*r,t},mat3$1.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},mat3$1.equals=function(t,e){var a=t[0],r=t[1],n=t[2],i=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=e[0],M=e[1],m=e[2],f=e[3],S=e[4],d=e[5],v=t[6],I=e[7],x=e[8];return Math.abs(a-h)<=glMatrix$5.EPSILON*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(r-M)<=glMatrix$5.EPSILON*Math.max(1,Math.abs(r),Math.abs(M))&&Math.abs(n-m)<=glMatrix$5.EPSILON*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(i-f)<=glMatrix$5.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-S)<=glMatrix$5.EPSILON*Math.max(1,Math.abs(o),Math.abs(S))&&Math.abs(s-d)<=glMatrix$5.EPSILON*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(l-v)<=glMatrix$5.EPSILON*Math.max(1,Math.abs(l),Math.abs(v))&&Math.abs(u-I)<=glMatrix$5.EPSILON*Math.max(1,Math.abs(u),Math.abs(I))&&Math.abs(c-x)<=glMatrix$5.EPSILON*Math.max(1,Math.abs(c),Math.abs(x))};var mat3_1=mat3$1,glMatrix$6=common,mat4$1={scalar:{},SIMD:{}};mat4$1.create=function(){var t=new glMatrix$6.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},mat4$1.clone=function(t){var e=new glMatrix$6.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},mat4$1.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},mat4$1.fromValues=function(t,e,a,r,n,i,o,s,l,u,c,h,M,m,f,S){var d=new glMatrix$6.ARRAY_TYPE(16);return d[0]=t,d[1]=e,d[2]=a,d[3]=r,d[4]=n,d[5]=i,d[6]=o,d[7]=s,d[8]=l,d[9]=u,d[10]=c,d[11]=h,d[12]=M,d[13]=m,d[14]=f,d[15]=S,d},mat4$1.set=function(t,e,a,r,n,i,o,s,l,u,c,h,M,m,f,S,d){return t[0]=e,t[1]=a,t[2]=r,t[3]=n,t[4]=i,t[5]=o,t[6]=s,t[7]=l,t[8]=u,t[9]=c,t[10]=h,t[11]=M,t[12]=m,t[13]=f,t[14]=S,t[15]=d,t},mat4$1.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},mat4$1.scalar.transpose=function(t,e){if(t===e){var a=e[1],r=e[2],n=e[3],i=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=a,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[11]=e[14],t[12]=n,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},mat4$1.SIMD.transpose=function(t,e){var a,r,n,i,o,s,l,u,c,h;return a=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),n=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),o=SIMD.Float32x4.shuffle(a,r,0,1,4,5),s=SIMD.Float32x4.shuffle(n,i,0,1,4,5),l=SIMD.Float32x4.shuffle(o,s,0,2,4,6),u=SIMD.Float32x4.shuffle(o,s,1,3,5,7),SIMD.Float32x4.store(t,0,l),SIMD.Float32x4.store(t,4,u),o=SIMD.Float32x4.shuffle(a,r,2,3,6,7),s=SIMD.Float32x4.shuffle(n,i,2,3,6,7),c=SIMD.Float32x4.shuffle(o,s,0,2,4,6),h=SIMD.Float32x4.shuffle(o,s,1,3,5,7),SIMD.Float32x4.store(t,8,c),SIMD.Float32x4.store(t,12,h),t},mat4$1.transpose=glMatrix$6.USE_SIMD?mat4$1.SIMD.transpose:mat4$1.scalar.transpose,mat4$1.scalar.invert=function(t,e){var a=e[0],r=e[1],n=e[2],i=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],M=e[10],m=e[11],f=e[12],S=e[13],d=e[14],v=e[15],I=a*s-r*o,x=a*l-n*o,D=a*u-i*o,g=r*l-n*s,$=r*u-i*s,E=n*u-i*l,p=c*S-h*f,T=c*d-M*f,F=c*v-m*f,b=h*d-M*S,_=h*v-m*S,P=M*v-m*d,A=I*P-x*_+D*b+g*F-$*T+E*p;return A?(A=1/A,t[0]=(s*P-l*_+u*b)*A,t[1]=(n*_-r*P-i*b)*A,t[2]=(S*E-d*$+v*g)*A,t[3]=(M*$-h*E-m*g)*A,t[4]=(l*F-o*P-u*T)*A,t[5]=(a*P-n*F+i*T)*A,t[6]=(d*D-f*E-v*x)*A,t[7]=(c*E-M*D+m*x)*A,t[8]=(o*_-s*F+u*p)*A,t[9]=(r*F-a*_-i*p)*A,t[10]=(f*$-S*D+v*I)*A,t[11]=(h*D-c*$-m*I)*A,t[12]=(s*T-o*b-l*p)*A,t[13]=(a*b-r*T+n*p)*A,t[14]=(S*x-f*g-d*I)*A,t[15]=(c*g-h*x+M*I)*A,t):null},mat4$1.SIMD.invert=function(t,e){var a,r,n,i,o,s,l,u,c,h,M=SIMD.Float32x4.load(e,0),m=SIMD.Float32x4.load(e,4),f=SIMD.Float32x4.load(e,8),S=SIMD.Float32x4.load(e,12);return o=SIMD.Float32x4.shuffle(M,m,0,1,4,5),r=SIMD.Float32x4.shuffle(f,S,0,1,4,5),a=SIMD.Float32x4.shuffle(o,r,0,2,4,6),r=SIMD.Float32x4.shuffle(r,o,1,3,5,7),o=SIMD.Float32x4.shuffle(M,m,2,3,6,7),i=SIMD.Float32x4.shuffle(f,S,2,3,6,7),n=SIMD.Float32x4.shuffle(o,i,0,2,4,6),i=SIMD.Float32x4.shuffle(i,o,1,3,5,7),o=SIMD.Float32x4.mul(n,i),o=SIMD.Float32x4.swizzle(o,1,0,3,2),s=SIMD.Float32x4.mul(r,o),l=SIMD.Float32x4.mul(a,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,o),s),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,o),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),o=SIMD.Float32x4.mul(r,n),o=SIMD.Float32x4.swizzle(o,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,o),s),c=SIMD.Float32x4.mul(a,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(i,o)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,o),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),o=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,2,3,0,1),i),o=SIMD.Float32x4.swizzle(o,1,0,3,2),n=SIMD.Float32x4.swizzle(n,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,o),s),u=SIMD.Float32x4.mul(a,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(n,o)),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,o),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),o=SIMD.Float32x4.mul(a,r),o=SIMD.Float32x4.swizzle(o,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,o),u),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,o),c),o=SIMD.Float32x4.swizzle(o,2,3,0,1),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,o),u),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(n,o)),o=SIMD.Float32x4.mul(a,i),o=SIMD.Float32x4.swizzle(o,1,0,3,2),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(n,o)),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,o),u),o=SIMD.Float32x4.swizzle(o,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,o),l),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(r,o)),o=SIMD.Float32x4.mul(a,n),o=SIMD.Float32x4.swizzle(o,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,o),l),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(r,o)),o=SIMD.Float32x4.swizzle(o,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(i,o)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,o),c),h=SIMD.Float32x4.mul(a,s),h=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(h,2,3,0,1),h),h=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(h,1,0,3,2),h),o=SIMD.Float32x4.reciprocalApproximation(h),h=SIMD.Float32x4.sub(SIMD.Float32x4.add(o,o),SIMD.Float32x4.mul(h,SIMD.Float32x4.mul(o,o))),(h=SIMD.Float32x4.swizzle(h,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(h,s)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(h,l)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(h,u)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(h,c)),t):null},mat4$1.invert=glMatrix$6.USE_SIMD?mat4$1.SIMD.invert:mat4$1.scalar.invert,mat4$1.scalar.adjoint=function(t,e){var a=e[0],r=e[1],n=e[2],i=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],M=e[10],m=e[11],f=e[12],S=e[13],d=e[14],v=e[15];return t[0]=s*(M*v-m*d)-h*(l*v-u*d)+S*(l*m-u*M),t[1]=-(r*(M*v-m*d)-h*(n*v-i*d)+S*(n*m-i*M)),t[2]=r*(l*v-u*d)-s*(n*v-i*d)+S*(n*u-i*l),t[3]=-(r*(l*m-u*M)-s*(n*m-i*M)+h*(n*u-i*l)),t[4]=-(o*(M*v-m*d)-c*(l*v-u*d)+f*(l*m-u*M)),t[5]=a*(M*v-m*d)-c*(n*v-i*d)+f*(n*m-i*M),t[6]=-(a*(l*v-u*d)-o*(n*v-i*d)+f*(n*u-i*l)),t[7]=a*(l*m-u*M)-o*(n*m-i*M)+c*(n*u-i*l),t[8]=o*(h*v-m*S)-c*(s*v-u*S)+f*(s*m-u*h),t[9]=-(a*(h*v-m*S)-c*(r*v-i*S)+f*(r*m-i*h)),t[10]=a*(s*v-u*S)-o*(r*v-i*S)+f*(r*u-i*s),t[11]=-(a*(s*m-u*h)-o*(r*m-i*h)+c*(r*u-i*s)),t[12]=-(o*(h*d-M*S)-c*(s*d-l*S)+f*(s*M-l*h)),t[13]=a*(h*d-M*S)-c*(r*d-n*S)+f*(r*M-n*h),t[14]=-(a*(s*d-l*S)-o*(r*d-n*S)+f*(r*l-n*s)),t[15]=a*(s*M-l*h)-o*(r*M-n*h)+c*(r*l-n*s),t},mat4$1.SIMD.adjoint=function(t,e){var a,r,n,i,o,s,l,u,c,h,M,m,f,a=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),n=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12);return c=SIMD.Float32x4.shuffle(a,r,0,1,4,5),s=SIMD.Float32x4.shuffle(n,i,0,1,4,5),o=SIMD.Float32x4.shuffle(c,s,0,2,4,6),s=SIMD.Float32x4.shuffle(s,c,1,3,5,7),c=SIMD.Float32x4.shuffle(a,r,2,3,6,7),u=SIMD.Float32x4.shuffle(n,i,2,3,6,7),l=SIMD.Float32x4.shuffle(c,u,0,2,4,6),u=SIMD.Float32x4.shuffle(u,c,1,3,5,7),c=SIMD.Float32x4.mul(l,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.mul(s,c),M=SIMD.Float32x4.mul(o,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),h),M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,c),M),M=SIMD.Float32x4.swizzle(M,2,3,0,1),c=SIMD.Float32x4.mul(s,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),h),f=SIMD.Float32x4.mul(o,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(u,c)),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,c),f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),c=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,3,0,1),u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),l=SIMD.Float32x4.swizzle(l,2,3,0,1),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),h),m=SIMD.Float32x4.mul(o,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(l,c)),m=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,c),m),m=SIMD.Float32x4.swizzle(m,2,3,0,1),c=SIMD.Float32x4.mul(o,s),c=SIMD.Float32x4.swizzle(c,1,0,3,2),m=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),m),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,c),f),c=SIMD.Float32x4.swizzle(c,2,3,0,1),m=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,c),m),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(l,c)),c=SIMD.Float32x4.mul(o,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(l,c)),m=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),m),c=SIMD.Float32x4.swizzle(c,2,3,0,1),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),M),m=SIMD.Float32x4.sub(m,SIMD.Float32x4.mul(s,c)),c=SIMD.Float32x4.mul(o,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),M),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(s,c)),c=SIMD.Float32x4.swizzle(c,2,3,0,1),M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(u,c)),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),f),SIMD.Float32x4.store(t,0,h),SIMD.Float32x4.store(t,4,M),SIMD.Float32x4.store(t,8,m),SIMD.Float32x4.store(t,12,f),t},mat4$1.adjoint=glMatrix$6.USE_SIMD?mat4$1.SIMD.adjoint:mat4$1.scalar.adjoint,mat4$1.determinant=function(t){var e=t[0],a=t[1],r=t[2],n=t[3],i=t[4],o=t[5],s=t[6],l=t[7],u=t[8],c=t[9],h=t[10],M=t[11],m=t[12],f=t[13],S=t[14],d=t[15],v=e*o-a*i,I=e*s-r*i,x=e*l-n*i,D=a*s-r*o,g=a*l-n*o,$=r*l-n*s,E=u*f-c*m,p=u*S-h*m,T=u*d-M*m,F=c*S-h*f,b=c*d-M*f,_=h*d-M*S;return v*_-I*b+x*F+D*T-g*p+$*E},mat4$1.SIMD.multiply=function(t,e,a){var r=SIMD.Float32x4.load(e,0),n=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4.load(a,0),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),o))));SIMD.Float32x4.store(t,0,l);var u=SIMD.Float32x4.load(a,4),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,3,3,3,3),o))));SIMD.Float32x4.store(t,4,c);var h=SIMD.Float32x4.load(a,8),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),o))));SIMD.Float32x4.store(t,8,M);var m=SIMD.Float32x4.load(a,12),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(m,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(m,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(m,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(m,3,3,3,3),o))));return SIMD.Float32x4.store(t,12,f),t},mat4$1.scalar.multiply=function(t,e,a){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],M=e[9],m=e[10],f=e[11],S=e[12],d=e[13],v=e[14],I=e[15],x=a[0],D=a[1],g=a[2],$=a[3];return t[0]=x*r+D*s+g*h+$*S,t[1]=x*n+D*l+g*M+$*d,t[2]=x*i+D*u+g*m+$*v,t[3]=x*o+D*c+g*f+$*I,x=a[4],D=a[5],g=a[6],$=a[7],t[4]=x*r+D*s+g*h+$*S,t[5]=x*n+D*l+g*M+$*d,t[6]=x*i+D*u+g*m+$*v,t[7]=x*o+D*c+g*f+$*I,x=a[8],D=a[9],g=a[10],$=a[11],t[8]=x*r+D*s+g*h+$*S,t[9]=x*n+D*l+g*M+$*d,t[10]=x*i+D*u+g*m+$*v,t[11]=x*o+D*c+g*f+$*I,x=a[12],D=a[13],g=a[14],$=a[15],t[12]=x*r+D*s+g*h+$*S,t[13]=x*n+D*l+g*M+$*d,t[14]=x*i+D*u+g*m+$*v,t[15]=x*o+D*c+g*f+$*I,t},mat4$1.multiply=glMatrix$6.USE_SIMD?mat4$1.SIMD.multiply:mat4$1.scalar.multiply,mat4$1.mul=mat4$1.multiply,mat4$1.scalar.translate=function(t,e,a){var r,n,i,o,s,l,u,c,h,M,m,f,S=a[0],d=a[1],v=a[2];return e===t?(t[12]=e[0]*S+e[4]*d+e[8]*v+e[12],t[13]=e[1]*S+e[5]*d+e[9]*v+e[13],t[14]=e[2]*S+e[6]*d+e[10]*v+e[14],t[15]=e[3]*S+e[7]*d+e[11]*v+e[15]):(r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],M=e[9],m=e[10],f=e[11],t[0]=r,t[1]=n,t[2]=i,t[3]=o,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=M,t[10]=m,t[11]=f,t[12]=r*S+s*d+h*v+e[12],t[13]=n*S+l*d+M*v+e[13],t[14]=i*S+u*d+m*v+e[14],t[15]=o*S+c*d+f*v+e[15]),t},mat4$1.SIMD.translate=function(t,e,a){var r=SIMD.Float32x4.load(e,0),n=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4(a[0],a[1],a[2],0);e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11]),r=SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(s,0,0,0,0)),n=SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(s,1,1,1,1)),i=SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(s,2,2,2,2));var l=SIMD.Float32x4.add(r,SIMD.Float32x4.add(n,SIMD.Float32x4.add(i,o)));return SIMD.Float32x4.store(t,12,l),t},mat4$1.translate=glMatrix$6.USE_SIMD?mat4$1.SIMD.translate:mat4$1.scalar.translate,mat4$1.scalar.scale=function(t,e,a){var r=a[0],n=a[1],i=a[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},mat4$1.SIMD.scale=function(t,e,a){var r,n,i,o=SIMD.Float32x4(a[0],a[1],a[2],0);return r=SIMD.Float32x4.load(e,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(o,0,0,0,0))),n=SIMD.Float32x4.load(e,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(o,1,1,1,1))),i=SIMD.Float32x4.load(e,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(o,2,2,2,2))),t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},mat4$1.scale=glMatrix$6.USE_SIMD?mat4$1.SIMD.scale:mat4$1.scalar.scale,mat4$1.rotate=function(t,e,a,r){var n,i,o,s,l,u,c,h,M,m,f,S,d,v,I,x,D,g,$,E,p,T,F,b,_=r[0],P=r[1],A=r[2],y=Math.sqrt(_*_+P*P+A*A);return Math.abs(y)<glMatrix$6.EPSILON?null:(y=1/y,_*=y,P*=y,A*=y,n=Math.sin(a),i=Math.cos(a),o=1-i,s=e[0],l=e[1],u=e[2],c=e[3],h=e[4],M=e[5],m=e[6],f=e[7],S=e[8],d=e[9],v=e[10],I=e[11],x=_*_*o+i,D=P*_*o+A*n,g=A*_*o-P*n,$=_*P*o-A*n,E=P*P*o+i,p=A*P*o+_*n,T=_*A*o+P*n,F=P*A*o-_*n,b=A*A*o+i,t[0]=s*x+h*D+S*g,t[1]=l*x+M*D+d*g,t[2]=u*x+m*D+v*g,t[3]=c*x+f*D+I*g,t[4]=s*$+h*E+S*p,t[5]=l*$+M*E+d*p,t[6]=u*$+m*E+v*p,t[7]=c*$+f*E+I*p,t[8]=s*T+h*F+S*b,t[9]=l*T+M*F+d*b,t[10]=u*T+m*F+v*b,t[11]=c*T+f*F+I*b,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},mat4$1.scalar.rotateX=function(t,e,a){var r=Math.sin(a),n=Math.cos(a),i=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],M=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*n+u*r,t[5]=o*n+c*r,t[6]=s*n+h*r,t[7]=l*n+M*r,t[8]=u*n-i*r,t[9]=c*n-o*r,t[10]=h*n-s*r,t[11]=M*n-l*r,t},mat4$1.SIMD.rotateX=function(t,e,a){var r=SIMD.Float32x4.splat(Math.sin(a)),n=SIMD.Float32x4.splat(Math.cos(a));e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var i=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(i,n),SIMD.Float32x4.mul(o,r))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(i,r))),t},mat4$1.rotateX=glMatrix$6.USE_SIMD?mat4$1.SIMD.rotateX:mat4$1.scalar.rotateX,mat4$1.scalar.rotateY=function(t,e,a){var r=Math.sin(a),n=Math.cos(a),i=e[0],o=e[1],s=e[2],l=e[3],u=e[8],c=e[9],h=e[10],M=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*n-u*r,t[1]=o*n-c*r,t[2]=s*n-h*r,t[3]=l*n-M*r,t[8]=i*r+u*n,t[9]=o*r+c*n,t[10]=s*r+h*n,t[11]=l*r+M*n,t},mat4$1.SIMD.rotateY=function(t,e,a){var r=SIMD.Float32x4.splat(Math.sin(a)),n=SIMD.Float32x4.splat(Math.cos(a));e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var i=SIMD.Float32x4.load(e,0),o=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,n),SIMD.Float32x4.mul(o,r))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(i,r),SIMD.Float32x4.mul(o,n))),t},mat4$1.rotateY=glMatrix$6.USE_SIMD?mat4$1.SIMD.rotateY:mat4$1.scalar.rotateY,mat4$1.scalar.rotateZ=function(t,e,a){var r=Math.sin(a),n=Math.cos(a),i=e[0],o=e[1],s=e[2],l=e[3],u=e[4],c=e[5],h=e[6],M=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*n+u*r,t[1]=o*n+c*r,t[2]=s*n+h*r,t[3]=l*n+M*r,t[4]=u*n-i*r,t[5]=c*n-o*r,t[6]=h*n-s*r,t[7]=M*n-l*r,t},mat4$1.SIMD.rotateZ=function(t,e,a){var r=SIMD.Float32x4.splat(Math.sin(a)),n=SIMD.Float32x4.splat(Math.cos(a));e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var i=SIMD.Float32x4.load(e,0),o=SIMD.Float32x4.load(e,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(i,n),SIMD.Float32x4.mul(o,r))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(i,r))),t},mat4$1.rotateZ=glMatrix$6.USE_SIMD?mat4$1.SIMD.rotateZ:mat4$1.scalar.rotateZ,mat4$1.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},mat4$1.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},mat4$1.fromRotation=function(t,e,a){var r,n,i,o=a[0],s=a[1],l=a[2],u=Math.sqrt(o*o+s*s+l*l);return Math.abs(u)<glMatrix$6.EPSILON?null:(u=1/u,o*=u,s*=u,l*=u,r=Math.sin(e),n=Math.cos(e),i=1-n,t[0]=o*o*i+n,t[1]=s*o*i+l*r,t[2]=l*o*i-s*r,t[3]=0,t[4]=o*s*i-l*r,t[5]=s*s*i+n,t[6]=l*s*i+o*r,t[7]=0,t[8]=o*l*i+s*r,t[9]=s*l*i-o*r,t[10]=l*l*i+n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},mat4$1.fromXRotation=function(t,e){var a=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=a,t[7]=0,t[8]=0,t[9]=-a,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},mat4$1.fromYRotation=function(t,e){var a=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-a,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=a,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},mat4$1.fromZRotation=function(t,e){var a=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=a,t[2]=0,t[3]=0,t[4]=-a,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},mat4$1.fromRotationTranslation=function(t,e,a){var r=e[0],n=e[1],i=e[2],o=e[3],s=r+r,l=n+n,u=i+i,c=r*s,h=r*l,M=r*u,m=n*l,f=n*u,S=i*u,d=o*s,v=o*l,I=o*u;return t[0]=1-(m+S),t[1]=h+I,t[2]=M-v,t[3]=0,t[4]=h-I,t[5]=1-(c+S),t[6]=f+d,t[7]=0,t[8]=M+v,t[9]=f-d,t[10]=1-(c+m),t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t},mat4$1.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},mat4$1.getRotation=function(t,e){var a=e[0]+e[5]+e[10],r=0;return a>0?(r=2*Math.sqrt(a+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t},mat4$1.fromRotationTranslationScale=function(t,e,a,r){var n=e[0],i=e[1],o=e[2],s=e[3],l=n+n,u=i+i,c=o+o,h=n*l,M=n*u,m=n*c,f=i*u,S=i*c,d=o*c,v=s*l,I=s*u,x=s*c,D=r[0],g=r[1],$=r[2];return t[0]=(1-(f+d))*D,t[1]=(M+x)*D,t[2]=(m-I)*D,t[3]=0,t[4]=(M-x)*g,t[5]=(1-(h+d))*g,t[6]=(S+v)*g,t[7]=0,t[8]=(m+I)*$,t[9]=(S-v)*$,t[10]=(1-(h+f))*$,t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t},mat4$1.fromRotationTranslationScaleOrigin=function(t,e,a,r,n){var i=e[0],o=e[1],s=e[2],l=e[3],u=i+i,c=o+o,h=s+s,M=i*u,m=i*c,f=i*h,S=o*c,d=o*h,v=s*h,I=l*u,x=l*c,D=l*h,g=r[0],$=r[1],E=r[2],p=n[0],T=n[1],F=n[2];return t[0]=(1-(S+v))*g,t[1]=(m+D)*g,t[2]=(f-x)*g,t[3]=0,t[4]=(m-D)*$,t[5]=(1-(M+v))*$,t[6]=(d+I)*$,t[7]=0,t[8]=(f+x)*E,t[9]=(d-I)*E,t[10]=(1-(M+S))*E,t[11]=0,t[12]=a[0]+p-(t[0]*p+t[4]*T+t[8]*F),t[13]=a[1]+T-(t[1]*p+t[5]*T+t[9]*F),t[14]=a[2]+F-(t[2]*p+t[6]*T+t[10]*F),t[15]=1,t},mat4$1.fromQuat=function(t,e){var a=e[0],r=e[1],n=e[2],i=e[3],o=a+a,s=r+r,l=n+n,u=a*o,c=r*o,h=r*s,M=n*o,m=n*s,f=n*l,S=i*o,d=i*s,v=i*l;return t[0]=1-h-f,t[1]=c+v,t[2]=M-d,t[3]=0,t[4]=c-v,t[5]=1-u-f,t[6]=m+S,t[7]=0,t[8]=M+d,t[9]=m-S,t[10]=1-u-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},mat4$1.frustum=function(t,e,a,r,n,i,o){var s=1/(a-e),l=1/(n-r),u=1/(i-o);return t[0]=2*i*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*l,t[6]=0,t[7]=0,t[8]=(a+e)*s,t[9]=(n+r)*l,t[10]=(o+i)*u,t[11]=-1,t[12]=0,
t[13]=0,t[14]=o*i*2*u,t[15]=0,t},mat4$1.perspective=function(t,e,a,r,n){var i=1/Math.tan(e/2),o=1/(r-n);return t[0]=i/a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(n+r)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*n*r*o,t[15]=0,t},mat4$1.perspectiveFromFieldOfView=function(t,e,a,r){var n=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+s),u=2/(n+i);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-((o-s)*l*.5),t[9]=(n-i)*u*.5,t[10]=r/(a-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*a/(a-r),t[15]=0,t},mat4$1.ortho=function(t,e,a,r,n,i,o){var s=1/(e-a),l=1/(r-n),u=1/(i-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+a)*s,t[13]=(n+r)*l,t[14]=(o+i)*u,t[15]=1,t},mat4$1.lookAt=function(t,e,a,r){var n,i,o,s,l,u,c,h,M,m,f=e[0],S=e[1],d=e[2],v=r[0],I=r[1],x=r[2],D=a[0],g=a[1],$=a[2];return Math.abs(f-D)<glMatrix$6.EPSILON&&Math.abs(S-g)<glMatrix$6.EPSILON&&Math.abs(d-$)<glMatrix$6.EPSILON?mat4$1.identity(t):(c=f-D,h=S-g,M=d-$,m=1/Math.sqrt(c*c+h*h+M*M),c*=m,h*=m,M*=m,n=I*M-x*h,i=x*c-v*M,o=v*h-I*c,m=Math.sqrt(n*n+i*i+o*o),m?(m=1/m,n*=m,i*=m,o*=m):(n=0,i=0,o=0),s=h*o-M*i,l=M*n-c*o,u=c*i-h*n,m=Math.sqrt(s*s+l*l+u*u),m?(m=1/m,s*=m,l*=m,u*=m):(s=0,l=0,u=0),t[0]=n,t[1]=s,t[2]=c,t[3]=0,t[4]=i,t[5]=l,t[6]=h,t[7]=0,t[8]=o,t[9]=u,t[10]=M,t[11]=0,t[12]=-(n*f+i*S+o*d),t[13]=-(s*f+l*S+u*d),t[14]=-(c*f+h*S+M*d),t[15]=1,t)},mat4$1.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},mat4$1.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},mat4$1.add=function(t,e,a){return t[0]=e[0]+a[0],t[1]=e[1]+a[1],t[2]=e[2]+a[2],t[3]=e[3]+a[3],t[4]=e[4]+a[4],t[5]=e[5]+a[5],t[6]=e[6]+a[6],t[7]=e[7]+a[7],t[8]=e[8]+a[8],t[9]=e[9]+a[9],t[10]=e[10]+a[10],t[11]=e[11]+a[11],t[12]=e[12]+a[12],t[13]=e[13]+a[13],t[14]=e[14]+a[14],t[15]=e[15]+a[15],t},mat4$1.subtract=function(t,e,a){return t[0]=e[0]-a[0],t[1]=e[1]-a[1],t[2]=e[2]-a[2],t[3]=e[3]-a[3],t[4]=e[4]-a[4],t[5]=e[5]-a[5],t[6]=e[6]-a[6],t[7]=e[7]-a[7],t[8]=e[8]-a[8],t[9]=e[9]-a[9],t[10]=e[10]-a[10],t[11]=e[11]-a[11],t[12]=e[12]-a[12],t[13]=e[13]-a[13],t[14]=e[14]-a[14],t[15]=e[15]-a[15],t},mat4$1.sub=mat4$1.subtract,mat4$1.multiplyScalar=function(t,e,a){return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12]*a,t[13]=e[13]*a,t[14]=e[14]*a,t[15]=e[15]*a,t},mat4$1.multiplyScalarAndAdd=function(t,e,a,r){return t[0]=e[0]+a[0]*r,t[1]=e[1]+a[1]*r,t[2]=e[2]+a[2]*r,t[3]=e[3]+a[3]*r,t[4]=e[4]+a[4]*r,t[5]=e[5]+a[5]*r,t[6]=e[6]+a[6]*r,t[7]=e[7]+a[7]*r,t[8]=e[8]+a[8]*r,t[9]=e[9]+a[9]*r,t[10]=e[10]+a[10]*r,t[11]=e[11]+a[11]*r,t[12]=e[12]+a[12]*r,t[13]=e[13]+a[13]*r,t[14]=e[14]+a[14]*r,t[15]=e[15]+a[15]*r,t},mat4$1.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},mat4$1.equals=function(t,e){var a=t[0],r=t[1],n=t[2],i=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],M=t[10],m=t[11],f=t[12],S=t[13],d=t[14],v=t[15],I=e[0],x=e[1],D=e[2],g=e[3],$=e[4],E=e[5],p=e[6],T=e[7],F=e[8],b=e[9],_=e[10],P=e[11],A=e[12],y=e[13],R=e[14],w=e[15];return Math.abs(a-I)<=glMatrix$6.EPSILON*Math.max(1,Math.abs(a),Math.abs(I))&&Math.abs(r-x)<=glMatrix$6.EPSILON*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(n-D)<=glMatrix$6.EPSILON*Math.max(1,Math.abs(n),Math.abs(D))&&Math.abs(i-g)<=glMatrix$6.EPSILON*Math.max(1,Math.abs(i),Math.abs(g))&&Math.abs(o-$)<=glMatrix$6.EPSILON*Math.max(1,Math.abs(o),Math.abs($))&&Math.abs(s-E)<=glMatrix$6.EPSILON*Math.max(1,Math.abs(s),Math.abs(E))&&Math.abs(l-p)<=glMatrix$6.EPSILON*Math.max(1,Math.abs(l),Math.abs(p))&&Math.abs(u-T)<=glMatrix$6.EPSILON*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(c-F)<=glMatrix$6.EPSILON*Math.max(1,Math.abs(c),Math.abs(F))&&Math.abs(h-b)<=glMatrix$6.EPSILON*Math.max(1,Math.abs(h),Math.abs(b))&&Math.abs(M-_)<=glMatrix$6.EPSILON*Math.max(1,Math.abs(M),Math.abs(_))&&Math.abs(m-P)<=glMatrix$6.EPSILON*Math.max(1,Math.abs(m),Math.abs(P))&&Math.abs(f-A)<=glMatrix$6.EPSILON*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(S-y)<=glMatrix$6.EPSILON*Math.max(1,Math.abs(S),Math.abs(y))&&Math.abs(d-R)<=glMatrix$6.EPSILON*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(v-w)<=glMatrix$6.EPSILON*Math.max(1,Math.abs(v),Math.abs(w))};var mat4_1=mat4$1,glMatrix$8=common,vec3$2={};vec3$2.create=function(){var t=new glMatrix$8.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},vec3$2.clone=function(t){var e=new glMatrix$8.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},vec3$2.fromValues=function(t,e,a){var r=new glMatrix$8.ARRAY_TYPE(3);return r[0]=t,r[1]=e,r[2]=a,r},vec3$2.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},vec3$2.set=function(t,e,a,r){return t[0]=e,t[1]=a,t[2]=r,t},vec3$2.add=function(t,e,a){return t[0]=e[0]+a[0],t[1]=e[1]+a[1],t[2]=e[2]+a[2],t},vec3$2.subtract=function(t,e,a){return t[0]=e[0]-a[0],t[1]=e[1]-a[1],t[2]=e[2]-a[2],t},vec3$2.sub=vec3$2.subtract,vec3$2.multiply=function(t,e,a){return t[0]=e[0]*a[0],t[1]=e[1]*a[1],t[2]=e[2]*a[2],t},vec3$2.mul=vec3$2.multiply,vec3$2.divide=function(t,e,a){return t[0]=e[0]/a[0],t[1]=e[1]/a[1],t[2]=e[2]/a[2],t},vec3$2.div=vec3$2.divide,vec3$2.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},vec3$2.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},vec3$2.min=function(t,e,a){return t[0]=Math.min(e[0],a[0]),t[1]=Math.min(e[1],a[1]),t[2]=Math.min(e[2],a[2]),t},vec3$2.max=function(t,e,a){return t[0]=Math.max(e[0],a[0]),t[1]=Math.max(e[1],a[1]),t[2]=Math.max(e[2],a[2]),t},vec3$2.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},vec3$2.scale=function(t,e,a){return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t},vec3$2.scaleAndAdd=function(t,e,a,r){return t[0]=e[0]+a[0]*r,t[1]=e[1]+a[1]*r,t[2]=e[2]+a[2]*r,t},vec3$2.distance=function(t,e){var a=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2];return Math.sqrt(a*a+r*r+n*n)},vec3$2.dist=vec3$2.distance,vec3$2.squaredDistance=function(t,e){var a=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2];return a*a+r*r+n*n},vec3$2.sqrDist=vec3$2.squaredDistance,vec3$2.length=function(t){var e=t[0],a=t[1],r=t[2];return Math.sqrt(e*e+a*a+r*r)},vec3$2.len=vec3$2.length,vec3$2.squaredLength=function(t){var e=t[0],a=t[1],r=t[2];return e*e+a*a+r*r},vec3$2.sqrLen=vec3$2.squaredLength,vec3$2.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},vec3$2.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},vec3$2.normalize=function(t,e){var a=e[0],r=e[1],n=e[2],i=a*a+r*r+n*n;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i),t},vec3$2.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},vec3$2.cross=function(t,e,a){var r=e[0],n=e[1],i=e[2],o=a[0],s=a[1],l=a[2];return t[0]=n*l-i*s,t[1]=i*o-r*l,t[2]=r*s-n*o,t},vec3$2.lerp=function(t,e,a,r){var n=e[0],i=e[1],o=e[2];return t[0]=n+r*(a[0]-n),t[1]=i+r*(a[1]-i),t[2]=o+r*(a[2]-o),t},vec3$2.hermite=function(t,e,a,r,n,i){var o=i*i,s=o*(2*i-3)+1,l=o*(i-2)+i,u=o*(i-1),c=o*(3-2*i);return t[0]=e[0]*s+a[0]*l+r[0]*u+n[0]*c,t[1]=e[1]*s+a[1]*l+r[1]*u+n[1]*c,t[2]=e[2]*s+a[2]*l+r[2]*u+n[2]*c,t},vec3$2.bezier=function(t,e,a,r,n,i){var o=1-i,s=o*o,l=i*i,u=s*o,c=3*i*s,h=3*l*o,M=l*i;return t[0]=e[0]*u+a[0]*c+r[0]*h+n[0]*M,t[1]=e[1]*u+a[1]*c+r[1]*h+n[1]*M,t[2]=e[2]*u+a[2]*c+r[2]*h+n[2]*M,t},vec3$2.random=function(t,e){e=e||1;var a=2*glMatrix$8.RANDOM()*Math.PI,r=2*glMatrix$8.RANDOM()-1,n=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(a)*n,t[1]=Math.sin(a)*n,t[2]=r*e,t},vec3$2.transformMat4=function(t,e,a){var r=e[0],n=e[1],i=e[2],o=a[3]*r+a[7]*n+a[11]*i+a[15];return o=o||1,t[0]=(a[0]*r+a[4]*n+a[8]*i+a[12])/o,t[1]=(a[1]*r+a[5]*n+a[9]*i+a[13])/o,t[2]=(a[2]*r+a[6]*n+a[10]*i+a[14])/o,t},vec3$2.transformMat3=function(t,e,a){var r=e[0],n=e[1],i=e[2];return t[0]=r*a[0]+n*a[3]+i*a[6],t[1]=r*a[1]+n*a[4]+i*a[7],t[2]=r*a[2]+n*a[5]+i*a[8],t},vec3$2.transformQuat=function(t,e,a){var r=e[0],n=e[1],i=e[2],o=a[0],s=a[1],l=a[2],u=a[3],c=u*r+s*i-l*n,h=u*n+l*r-o*i,M=u*i+o*n-s*r,m=-o*r-s*n-l*i;return t[0]=c*u+m*-o+h*-l-M*-s,t[1]=h*u+m*-s+M*-o-c*-l,t[2]=M*u+m*-l+c*-s-h*-o,t},vec3$2.rotateX=function(t,e,a,r){var n=[],i=[];return n[0]=e[0]-a[0],n[1]=e[1]-a[1],n[2]=e[2]-a[2],i[0]=n[0],i[1]=n[1]*Math.cos(r)-n[2]*Math.sin(r),i[2]=n[1]*Math.sin(r)+n[2]*Math.cos(r),t[0]=i[0]+a[0],t[1]=i[1]+a[1],t[2]=i[2]+a[2],t},vec3$2.rotateY=function(t,e,a,r){var n=[],i=[];return n[0]=e[0]-a[0],n[1]=e[1]-a[1],n[2]=e[2]-a[2],i[0]=n[2]*Math.sin(r)+n[0]*Math.cos(r),i[1]=n[1],i[2]=n[2]*Math.cos(r)-n[0]*Math.sin(r),t[0]=i[0]+a[0],t[1]=i[1]+a[1],t[2]=i[2]+a[2],t},vec3$2.rotateZ=function(t,e,a,r){var n=[],i=[];return n[0]=e[0]-a[0],n[1]=e[1]-a[1],n[2]=e[2]-a[2],i[0]=n[0]*Math.cos(r)-n[1]*Math.sin(r),i[1]=n[0]*Math.sin(r)+n[1]*Math.cos(r),i[2]=n[2],t[0]=i[0]+a[0],t[1]=i[1]+a[1],t[2]=i[2]+a[2],t},vec3$2.forEach=function(){var t=vec3$2.create();return function(e,a,r,n,i,o){var s,l;for(a||(a=3),r||(r=0),l=n?Math.min(n*a+r,e.length):e.length,s=r;s<l;s+=a)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],i(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}(),vec3$2.angle=function(t,e){var a=vec3$2.fromValues(t[0],t[1],t[2]),r=vec3$2.fromValues(e[0],e[1],e[2]);vec3$2.normalize(a,a),vec3$2.normalize(r,r);var n=vec3$2.dot(a,r);return n>1?0:Math.acos(n)},vec3$2.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},vec3$2.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},vec3$2.equals=function(t,e){var a=t[0],r=t[1],n=t[2],i=e[0],o=e[1],s=e[2];return Math.abs(a-i)<=glMatrix$8.EPSILON*Math.max(1,Math.abs(a),Math.abs(i))&&Math.abs(r-o)<=glMatrix$8.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=glMatrix$8.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))};var vec3_1=vec3$2,glMatrix$9=common,vec4$2={};vec4$2.create=function(){var t=new glMatrix$9.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},vec4$2.clone=function(t){var e=new glMatrix$9.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},vec4$2.fromValues=function(t,e,a,r){var n=new glMatrix$9.ARRAY_TYPE(4);return n[0]=t,n[1]=e,n[2]=a,n[3]=r,n},vec4$2.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},vec4$2.set=function(t,e,a,r,n){return t[0]=e,t[1]=a,t[2]=r,t[3]=n,t},vec4$2.add=function(t,e,a){return t[0]=e[0]+a[0],t[1]=e[1]+a[1],t[2]=e[2]+a[2],t[3]=e[3]+a[3],t},vec4$2.subtract=function(t,e,a){return t[0]=e[0]-a[0],t[1]=e[1]-a[1],t[2]=e[2]-a[2],t[3]=e[3]-a[3],t},vec4$2.sub=vec4$2.subtract,vec4$2.multiply=function(t,e,a){return t[0]=e[0]*a[0],t[1]=e[1]*a[1],t[2]=e[2]*a[2],t[3]=e[3]*a[3],t},vec4$2.mul=vec4$2.multiply,vec4$2.divide=function(t,e,a){return t[0]=e[0]/a[0],t[1]=e[1]/a[1],t[2]=e[2]/a[2],t[3]=e[3]/a[3],t},vec4$2.div=vec4$2.divide,vec4$2.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},vec4$2.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},vec4$2.min=function(t,e,a){return t[0]=Math.min(e[0],a[0]),t[1]=Math.min(e[1],a[1]),t[2]=Math.min(e[2],a[2]),t[3]=Math.min(e[3],a[3]),t},vec4$2.max=function(t,e,a){return t[0]=Math.max(e[0],a[0]),t[1]=Math.max(e[1],a[1]),t[2]=Math.max(e[2],a[2]),t[3]=Math.max(e[3],a[3]),t},vec4$2.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},vec4$2.scale=function(t,e,a){return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t},vec4$2.scaleAndAdd=function(t,e,a,r){return t[0]=e[0]+a[0]*r,t[1]=e[1]+a[1]*r,t[2]=e[2]+a[2]*r,t[3]=e[3]+a[3]*r,t},vec4$2.distance=function(t,e){var a=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2],i=e[3]-t[3];return Math.sqrt(a*a+r*r+n*n+i*i)},vec4$2.dist=vec4$2.distance,vec4$2.squaredDistance=function(t,e){var a=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2],i=e[3]-t[3];return a*a+r*r+n*n+i*i},vec4$2.sqrDist=vec4$2.squaredDistance,vec4$2.length=function(t){var e=t[0],a=t[1],r=t[2],n=t[3];return Math.sqrt(e*e+a*a+r*r+n*n)},vec4$2.len=vec4$2.length,vec4$2.squaredLength=function(t){var e=t[0],a=t[1],r=t[2],n=t[3];return e*e+a*a+r*r+n*n},vec4$2.sqrLen=vec4$2.squaredLength,vec4$2.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},vec4$2.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},vec4$2.normalize=function(t,e){var a=e[0],r=e[1],n=e[2],i=e[3],o=a*a+r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=a*o,t[1]=r*o,t[2]=n*o,t[3]=i*o),t},vec4$2.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},vec4$2.lerp=function(t,e,a,r){var n=e[0],i=e[1],o=e[2],s=e[3];return t[0]=n+r*(a[0]-n),t[1]=i+r*(a[1]-i),t[2]=o+r*(a[2]-o),t[3]=s+r*(a[3]-s),t},vec4$2.random=function(t,e){return e=e||1,t[0]=glMatrix$9.RANDOM(),t[1]=glMatrix$9.RANDOM(),t[2]=glMatrix$9.RANDOM(),t[3]=glMatrix$9.RANDOM(),vec4$2.normalize(t,t),vec4$2.scale(t,t,e),t},vec4$2.transformMat4=function(t,e,a){var r=e[0],n=e[1],i=e[2],o=e[3];return t[0]=a[0]*r+a[4]*n+a[8]*i+a[12]*o,t[1]=a[1]*r+a[5]*n+a[9]*i+a[13]*o,t[2]=a[2]*r+a[6]*n+a[10]*i+a[14]*o,t[3]=a[3]*r+a[7]*n+a[11]*i+a[15]*o,t},vec4$2.transformQuat=function(t,e,a){var r=e[0],n=e[1],i=e[2],o=a[0],s=a[1],l=a[2],u=a[3],c=u*r+s*i-l*n,h=u*n+l*r-o*i,M=u*i+o*n-s*r,m=-o*r-s*n-l*i;return t[0]=c*u+m*-o+h*-l-M*-s,t[1]=h*u+m*-s+M*-o-c*-l,t[2]=M*u+m*-l+c*-s-h*-o,t[3]=e[3],t},vec4$2.forEach=function(){var t=vec4$2.create();return function(e,a,r,n,i,o){var s,l;for(a||(a=4),r||(r=0),l=n?Math.min(n*a+r,e.length):e.length,s=r;s<l;s+=a)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],i(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}(),vec4$2.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},vec4$2.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},vec4$2.equals=function(t,e){var a=t[0],r=t[1],n=t[2],i=t[3],o=e[0],s=e[1],l=e[2],u=e[3];return Math.abs(a-o)<=glMatrix$9.EPSILON*Math.max(1,Math.abs(a),Math.abs(o))&&Math.abs(r-s)<=glMatrix$9.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-l)<=glMatrix$9.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-u)<=glMatrix$9.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))};var vec4_1=vec4$2,glMatrix$7=common,mat3$2=mat3_1,vec3$1=vec3_1,vec4$1=vec4_1,quat$1={};quat$1.create=function(){var t=new glMatrix$7.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},quat$1.rotationTo=function(){var t=vec3$1.create(),e=vec3$1.fromValues(1,0,0),a=vec3$1.fromValues(0,1,0);return function(r,n,i){var o=vec3$1.dot(n,i);return o<-.999999?(vec3$1.cross(t,e,n),vec3$1.length(t)<1e-6&&vec3$1.cross(t,a,n),vec3$1.normalize(t,t),quat$1.setAxisAngle(r,t,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(vec3$1.cross(t,n,i),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+o,quat$1.normalize(r,r))}}(),quat$1.setAxes=function(){var t=mat3$2.create();return function(e,a,r,n){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=n[0],t[4]=n[1],t[7]=n[2],t[2]=-a[0],t[5]=-a[1],t[8]=-a[2],quat$1.normalize(e,quat$1.fromMat3(e,t))}}(),quat$1.clone=vec4$1.clone,quat$1.fromValues=vec4$1.fromValues,quat$1.copy=vec4$1.copy,quat$1.set=vec4$1.set,quat$1.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},quat$1.setAxisAngle=function(t,e,a){a*=.5;var r=Math.sin(a);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(a),t},quat$1.getAxisAngle=function(t,e){var a=2*Math.acos(e[3]),r=Math.sin(a/2);return 0!=r?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),a},quat$1.add=vec4$1.add,quat$1.multiply=function(t,e,a){var r=e[0],n=e[1],i=e[2],o=e[3],s=a[0],l=a[1],u=a[2],c=a[3];return t[0]=r*c+o*s+n*u-i*l,t[1]=n*c+o*l+i*s-r*u,t[2]=i*c+o*u+r*l-n*s,t[3]=o*c-r*s-n*l-i*u,t},quat$1.mul=quat$1.multiply,quat$1.scale=vec4$1.scale,quat$1.rotateX=function(t,e,a){a*=.5;var r=e[0],n=e[1],i=e[2],o=e[3],s=Math.sin(a),l=Math.cos(a);return t[0]=r*l+o*s,t[1]=n*l+i*s,t[2]=i*l-n*s,t[3]=o*l-r*s,t},quat$1.rotateY=function(t,e,a){a*=.5;var r=e[0],n=e[1],i=e[2],o=e[3],s=Math.sin(a),l=Math.cos(a);return t[0]=r*l-i*s,t[1]=n*l+o*s,t[2]=i*l+r*s,t[3]=o*l-n*s,t},quat$1.rotateZ=function(t,e,a){a*=.5;var r=e[0],n=e[1],i=e[2],o=e[3],s=Math.sin(a),l=Math.cos(a);return t[0]=r*l+n*s,t[1]=n*l-r*s,t[2]=i*l+o*s,t[3]=o*l-i*s,t},quat$1.calculateW=function(t,e){var a=e[0],r=e[1],n=e[2];return t[0]=a,t[1]=r,t[2]=n,t[3]=Math.sqrt(Math.abs(1-a*a-r*r-n*n)),t},quat$1.dot=vec4$1.dot,quat$1.lerp=vec4$1.lerp,quat$1.slerp=function(t,e,a,r){var n,i,o,s,l,u=e[0],c=e[1],h=e[2],M=e[3],m=a[0],f=a[1],S=a[2],d=a[3];return i=u*m+c*f+h*S+M*d,i<0&&(i=-i,m=-m,f=-f,S=-S,d=-d),1-i>1e-6?(n=Math.acos(i),o=Math.sin(n),s=Math.sin((1-r)*n)/o,l=Math.sin(r*n)/o):(s=1-r,l=r),t[0]=s*u+l*m,t[1]=s*c+l*f,t[2]=s*h+l*S,t[3]=s*M+l*d,t},quat$1.sqlerp=function(){var t=quat$1.create(),e=quat$1.create();return function(a,r,n,i,o,s){return quat$1.slerp(t,r,o,s),quat$1.slerp(e,n,i,s),quat$1.slerp(a,t,e,2*s*(1-s)),a}}(),quat$1.invert=function(t,e){var a=e[0],r=e[1],n=e[2],i=e[3],o=a*a+r*r+n*n+i*i,s=o?1/o:0;return t[0]=-a*s,t[1]=-r*s,t[2]=-n*s,t[3]=i*s,t},quat$1.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},quat$1.length=vec4$1.length,quat$1.len=quat$1.length,quat$1.squaredLength=vec4$1.squaredLength,quat$1.sqrLen=quat$1.squaredLength,quat$1.normalize=vec4$1.normalize,quat$1.fromMat3=function(t,e){var a,r=e[0]+e[4]+e[8];if(r>0)a=Math.sqrt(r+1),t[3]=.5*a,a=.5/a,t[0]=(e[5]-e[7])*a,t[1]=(e[6]-e[2])*a,t[2]=(e[1]-e[3])*a;else{var n=0;e[4]>e[0]&&(n=1),e[8]>e[3*n+n]&&(n=2);var i=(n+1)%3,o=(n+2)%3;a=Math.sqrt(e[3*n+n]-e[3*i+i]-e[3*o+o]+1),t[n]=.5*a,a=.5/a,t[3]=(e[3*i+o]-e[3*o+i])*a,t[i]=(e[3*i+n]+e[3*n+i])*a,t[o]=(e[3*o+n]+e[3*n+o])*a}return t},quat$1.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},quat$1.exactEquals=vec4$1.exactEquals,quat$1.equals=vec4$1.equals;var glMatrix$10=common,vec2$1={};vec2$1.create=function(){var t=new glMatrix$10.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},vec2$1.clone=function(t){var e=new glMatrix$10.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},vec2$1.fromValues=function(t,e){var a=new glMatrix$10.ARRAY_TYPE(2);return a[0]=t,a[1]=e,a},vec2$1.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},vec2$1.set=function(t,e,a){return t[0]=e,t[1]=a,t},vec2$1.add=function(t,e,a){return t[0]=e[0]+a[0],t[1]=e[1]+a[1],t},vec2$1.subtract=function(t,e,a){return t[0]=e[0]-a[0],t[1]=e[1]-a[1],t},vec2$1.sub=vec2$1.subtract,vec2$1.multiply=function(t,e,a){return t[0]=e[0]*a[0],t[1]=e[1]*a[1],t},vec2$1.mul=vec2$1.multiply,vec2$1.divide=function(t,e,a){return t[0]=e[0]/a[0],t[1]=e[1]/a[1],t},vec2$1.div=vec2$1.divide,vec2$1.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},vec2$1.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},vec2$1.min=function(t,e,a){return t[0]=Math.min(e[0],a[0]),t[1]=Math.min(e[1],a[1]),t},vec2$1.max=function(t,e,a){return t[0]=Math.max(e[0],a[0]),t[1]=Math.max(e[1],a[1]),t},vec2$1.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},vec2$1.scale=function(t,e,a){return t[0]=e[0]*a,t[1]=e[1]*a,t},vec2$1.scaleAndAdd=function(t,e,a,r){return t[0]=e[0]+a[0]*r,t[1]=e[1]+a[1]*r,t},vec2$1.distance=function(t,e){var a=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(a*a+r*r)},vec2$1.dist=vec2$1.distance,vec2$1.squaredDistance=function(t,e){var a=e[0]-t[0],r=e[1]-t[1];return a*a+r*r},vec2$1.sqrDist=vec2$1.squaredDistance,vec2$1.length=function(t){var e=t[0],a=t[1];return Math.sqrt(e*e+a*a)},vec2$1.len=vec2$1.length,vec2$1.squaredLength=function(t){var e=t[0],a=t[1];return e*e+a*a},vec2$1.sqrLen=vec2$1.squaredLength,vec2$1.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},vec2$1.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},vec2$1.normalize=function(t,e){var a=e[0],r=e[1],n=a*a+r*r;return n>0&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n),t},vec2$1.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},vec2$1.cross=function(t,e,a){var r=e[0]*a[1]-e[1]*a[0];return t[0]=t[1]=0,t[2]=r,t},vec2$1.lerp=function(t,e,a,r){var n=e[0],i=e[1];return t[0]=n+r*(a[0]-n),t[1]=i+r*(a[1]-i),t},vec2$1.random=function(t,e){e=e||1;var a=2*glMatrix$10.RANDOM()*Math.PI;return t[0]=Math.cos(a)*e,t[1]=Math.sin(a)*e,t},vec2$1.transformMat2=function(t,e,a){var r=e[0],n=e[1];return t[0]=a[0]*r+a[2]*n,t[1]=a[1]*r+a[3]*n,t},vec2$1.transformMat2d=function(t,e,a){var r=e[0],n=e[1];return t[0]=a[0]*r+a[2]*n+a[4],t[1]=a[1]*r+a[3]*n+a[5],t},vec2$1.transformMat3=function(t,e,a){var r=e[0],n=e[1];return t[0]=a[0]*r+a[3]*n+a[6],t[1]=a[1]*r+a[4]*n+a[7],t},vec2$1.transformMat4=function(t,e,a){var r=e[0],n=e[1];return t[0]=a[0]*r+a[4]*n+a[12],t[1]=a[1]*r+a[5]*n+a[13],t},vec2$1.forEach=function(){var t=vec2$1.create();return function(e,a,r,n,i,o){var s,l;for(a||(a=2),r||(r=0),l=n?Math.min(n*a+r,e.length):e.length,s=r;s<l;s+=a)t[0]=e[s],t[1]=e[s+1],i(t,t,o),e[s]=t[0],e[s+1]=t[1];return e}}(),vec2$1.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},vec2$1.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},vec2$1.equals=function(t,e){var a=t[0],r=t[1],n=e[0],i=e[1];return Math.abs(a-n)<=glMatrix$10.EPSILON*Math.max(1,Math.abs(a),Math.abs(n))&&Math.abs(r-i)<=glMatrix$10.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))};var vec2_1=vec2$1,mat4=mat4_1,vec2=vec2_1,vec3=vec3_1,Model=function(){function t(e,a){classCallCheck(this,t),this.geometry=e,this.texture=a,this.position=vec3.fromValues(0,0,0),this.uvOffset=vec2.fromValues(0,0),this.uvScale=vec2.fromValues(1,1),this.euler=vec3.fromValues(0,0,0),this.transform=mat4.create(),this.needsUpdate=!0,this.visible=!0}return createClass(t,[{key:"getTransform",value:function(){return this.needsUpdate&&(mat4.identity(this.transform),mat4.rotateX(this.transform,this.transform,this.euler[0]),mat4.rotateY(this.transform,this.transform,this.euler[1]),mat4.rotateZ(this.transform,this.transform,this.euler[2]),mat4.translate(this.transform,this.transform,this.position),this.needsUpdate=!1),this.transform}},{key:"setSpritePosition",value:function(t,e,a,r,n,i){vec2.set(this.uvOffset,a/t,r/e),vec2.set(this.uvScale,n/t,i/e)}}]),t}(),Texture=function(){function t(e){classCallCheck(this,t),this.id=gl.createTexture(),this.update(e),gl.generateMipmap(gl.TEXTURE_2D),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST_MIPMAP_NEAREST),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST)}return createClass(t,[{key:"update",value:function(t){gl.bindTexture(gl.TEXTURE_2D,this.id),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,t)}},{key:"bind",value:function(t){gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,this.id)}}]),t}(),dimensions={WIDTH:10,HEIGHT:13,DEST_WIDTH:11},config$1={MAX_DISTANCE_UNITS:5,ACHIEVEMENT_DISTANCE:100,COEFFICIENT:.025,FLASH_DURATION:250,FLASH_ITERATIONS:3},maxWidth=2*dimensions.DEST_WIDTH*(config$1.MAX_DISTANCE_UNITS+2),DistanceMeter=function(t){function e(t,a,r){classCallCheck(this,e);var n=document.createElement("canvas");n.width=maxWidth,n.height=maxWidth;var i=new Texture(n),o=n.getContext("2d");if(!o)throw new Error("Couldn't create a rendering context for the distance meter");o.imageSmoothingEnabled=!1;var s=possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,quad,i));return s.canvas=n,s.ctx=o,s.spriteMap=t,s.spriteX=a,s.spriteY=r,s.maxScore=Math.pow(10,config$1.MAX_DISTANCE_UNITS)-1,s.highScore=0,s.flashCounter=0,s.flashTimer=0,s.flashScore=0,s}return inherits(e,t),createClass(e,[{key:"drawDigit",value:function(t,e){this.ctx.drawImage(this.spriteMap,this.spriteX+e*dimensions.WIDTH,this.spriteY,dimensions.WIDTH,dimensions.HEIGHT,t*dimensions.DEST_WIDTH,1,dimensions.DEST_WIDTH,dimensions.HEIGHT)}},{key:"drawScore",value:function(t,e){e=Math.floor(e),e>this.maxScore&&(e=this.maxScore),this.drawDigit(t+4,e%10),e=Math.floor(e/10),this.drawDigit(t+3,e%10),e=Math.floor(e/10),this.drawDigit(t+2,e%10),e=Math.floor(e/10),this.drawDigit(t+1,e%10),e=Math.floor(e/10),this.drawDigit(t,e%10)}},{key:"getActualDistance",value:function(t){return t?Math.round(t*config$1.COEFFICIENT):0}},{key:"update",value:function(t,e){var a=!1;this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.highScore>0&&(this.ctx.globalAlpha=.8,this.drawDigit(0,10),this.drawDigit(1,11),this.drawScore(3,this.highScore),this.ctx.globalAlpha=1);var r=this.getActualDistance(e);return r>0&&r%config$1.ACHIEVEMENT_DISTANCE===0&&this.flashScore!==r&&(this.flashCounter=config$1.FLASH_ITERATIONS,this.flashTimer=2*config$1.FLASH_DURATION,this.flashScore=r,a=!0),this.flashCounter>0||this.flashTimer>0?(this.flashTimer<config$1.FLASH_DURATION&&this.drawScore(9,this.flashScore),this.flashTimer-=t,this.flashTimer<0&&(this.flashTimer+=2*config$1.FLASH_DURATION,this.flashCounter--,this.flashCounter<0&&(this.flashCounter=0,this.flashTimer=0))):this.drawScore(9,r),this.texture.update(this.canvas),a}},{key:"setHighScore",value:function(t){this.highScore=this.getActualDistance(t)}},{key:"reset",value:function(){this.update(0,0)}}]),e}(Model),SPRITE_MAP_WIDTH=1233,SPRITE_MAP_HEIGHT=68,srcPos={text:{t:15,l:655,b:26,r:846},restart:{t:2,l:2,b:34,r:38}},dstPos={text:{t:.34,l:-1,b:.225,r:1},restart:{t:-.11,l:-.188,b:-.34,r:.188}},TEXT_UVS={l:srcPos.text.l/SPRITE_MAP_WIDTH,r:srcPos.text.r/SPRITE_MAP_WIDTH,t:srcPos.text.t/SPRITE_MAP_HEIGHT,b:srcPos.text.b/SPRITE_MAP_HEIGHT},RESTART_UVS={l:srcPos.restart.l/SPRITE_MAP_WIDTH,r:srcPos.restart.r/SPRITE_MAP_WIDTH,t:srcPos.restart.t/SPRITE_MAP_HEIGHT,b:srcPos.restart.b/SPRITE_MAP_HEIGHT},index=new Uint16Array([0,1,3,1,2,3,4,5,7,5,6,7]),uvs=new Float32Array([TEXT_UVS.l,TEXT_UVS.t,TEXT_UVS.r,TEXT_UVS.t,TEXT_UVS.r,TEXT_UVS.b,TEXT_UVS.l,TEXT_UVS.b,RESTART_UVS.l,RESTART_UVS.t,RESTART_UVS.r,RESTART_UVS.t,RESTART_UVS.r,RESTART_UVS.b,RESTART_UVS.l,RESTART_UVS.b]),positions=new Float32Array([dstPos.text.l,dstPos.text.t,0,dstPos.text.r,dstPos.text.t,0,dstPos.text.r,dstPos.text.b,0,dstPos.text.l,dstPos.text.b,0,dstPos.restart.l,dstPos.restart.t,0,dstPos.restart.r,dstPos.restart.t,0,dstPos.restart.r,dstPos.restart.b,0,dstPos.restart.l,dstPos.restart.b,0]),geometry=new Geometry(index,positions,uvs),GameOverPanel=function(t){function e(t){return classCallCheck(this,e),possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,geometry,t))}return inherits(e,t),e}(Model),IS_IOS=/iPad|iPhone|iPod/.test(window.navigator.platform),IS_MOBILE=/Android/.test(window.navigator.userAgent)||IS_IOS,SPRITE_MAP_WIDTH$1=1233,SPRITE_MAP_HEIGHT$1=68,SPRITE_X=86,SPRITE_Y=2,SPRITE_WIDTH=46,SPRITE_HEIGHT=14,config$2={MAX_CLOUD_GAP:400,MAX_SKY_LEVEL:4,MIN_CLOUD_GAP:100,MIN_SKY_LEVEL:1},Cloud=function(t){function e(t){classCallCheck(this,e);var a=possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,quad,t));return a.euler[1]=Math.PI,a.position[1]=random(config$2.MIN_SKY_LEVEL,config$2.MAX_SKY_LEVEL),a.setSpritePosition(SPRITE_MAP_WIDTH$1,SPRITE_MAP_HEIGHT$1,SPRITE_X,SPRITE_Y,SPRITE_WIDTH,SPRITE_HEIGHT),a}return inherits(e,t),createClass(e,[{key:"update",value:function(t){this.euler[1]+=t,this.euler[1]>2*Math.PI&&(this.euler[1]-=2*Math.PI),this.euler[1]-Math.PI<t&&this.euler[1]-Math.PI>0&&(console.log(t,this.euler[1]-Math.PI),this.position[1]=random(config$2.MIN_SKY_LEVEL,config$2.MAX_SKY_LEVEL)),this.needsUpdate=!0}}]),e}(Model),CollisionBox=function(){function t(e,a,r,n){classCallCheck(this,t),this.x=e,this.y=a,this.width=r,this.height=n}return createClass(t,[{key:"clone",value:function(){return new t(this.x,this.y,this.width,this.height)}}]),t}(),SPRITE_MAP_WIDTH$2=1233,SPRITE_MAP_HEIGHT$2=68,GAP_COEFFICIENT=.6,MAX_GAP_COEFFICIENT=1.5,MAX_OBSTACLE_LENGTH=3,Obstacle=function(t){function e(t){classCallCheck(this,e);var a=possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,quad,t));return a.size=randomInt(1,MAX_OBSTACLE_LENGTH),a.remove=!1,a.width=0,a.collisionBoxes=[],a.gap=0,a}return inherits(e,t),createClass(e,[{key:"init",value:function(t){this.size>1&&this.multipleSpeed>t&&(this.size=1),this.width=this.width*this.size,this.draw(),this.size>1&&(this.collisionBoxes[1].width=this.width-this.collisionBoxes[0].width-this.collisionBoxes[2].width,this.collisionBoxes[2].x=this.width-this.collisionBoxes[2].width),this.gap=this.getGap(GAP_COEFFICIENT,t)}},{key:"draw",value:function(){this.setSpritePosition(SPRITE_MAP_WIDTH$2,SPRITE_MAP_HEIGHT$2,this.spriteX,this.spriteY,this.width,this.height)}},{key:"update",value:function(t,e){this.euler[1]+=60*e/1e3*t,this.needsUpdate=!0,this.draw()}},{key:"getGap",value:function(t,e){var a=Math.round(this.width*e+this.minGap*t),r=Math.round(a*MAX_GAP_COEFFICIENT);return randomInt(a,r)}},{key:"setY",value:function(t){this.position[1]=(140-t-this.height)/15,this.needsUpdate=!0}}]),e}(Model),SmallCactus=function(t){function e(t,a){classCallCheck(this,e);var r=possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.width=17,r.height=35,r.setY(105),r.multipleSpeed=4,r.minGap=120,r.minSpeed=0,r.spriteX=228,r.spriteY=2,r.collisionBoxes=[new CollisionBox(0,7,5,27),new CollisionBox(4,0,6,34),new CollisionBox(10,4,7,14)],r.init(a),r}return inherits(e,t),e}(Obstacle),LargeCactus=function(t){function e(t,a){classCallCheck(this,e);var r=possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.width=25,r.height=50,r.setY(90),r.multipleSpeed=7,r.minGap=120,r.minSpeed=0,r.spriteX=332,r.spriteY=2,r.collisionBoxes=[new CollisionBox(0,12,7,38),new CollisionBox(8,0,7,49),new CollisionBox(13,10,10,38)],r.init(a),r}return inherits(e,t),e}(Obstacle),Pterodactyl=function(t){function e(t,a){classCallCheck(this,e);var r=possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.width=46,r.height=40,r.yPositions=[100,75,50],r.multipleSpeed=999,r.minSpeed=8.5,r.minGap=150,r.spriteX=134,r.spriteY=2,r.collisionBoxes=[new CollisionBox(15,15,16,5),new CollisionBox(18,21,24,6),new CollisionBox(2,14,4,3),new CollisionBox(6,10,4,7),new CollisionBox(10,8,6,9)],r.numFrames=2,r.frameRate=1e3/6,r.speedOffset=.002,r.currentFrame=0,r.timer=0,r.init(a),r}return inherits(e,t),createClass(e,[{key:"init",value:function(t){this.setY(this.yPositions[randomInt(0,this.yPositions.length-1)]),this.speedOffset&&(this.speedOffset=Math.random()>.5?this.speedOffset:-this.speedOffset),get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this,t)}},{key:"draw",value:function(){var t=this.spriteX;this.currentFrame>0&&(t+=this.width*this.currentFrame),this.setSpritePosition(SPRITE_MAP_WIDTH$2,SPRITE_MAP_HEIGHT$2,t,this.spriteY,this.width,this.height)}},{key:"update",value:function(t,a){a+=this.speedOffset,this.timer+=t,this.timer>=this.frameRate&&(this.currentFrame=(this.currentFrame+1)%this.numFrames,this.timer=0),get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,t,a)}}]),e}(Obstacle),ShaderProgram=function(){function t(e,a){classCallCheck(this,t);var r=this.compileShader(e,gl.VERTEX_SHADER),n=this.compileShader(a,gl.FRAGMENT_SHADER),i=gl.createProgram();if(gl.attachShader(i,r),gl.attachShader(i,n),gl.linkProgram(i),!gl.getProgramParameter(i,gl.LINK_STATUS)){var o=gl.getProgramInfoLog(i);throw new Error("Could not link shader program. \n\n"+o)}if(gl.validateProgram(i),!gl.getProgramParameter(i,gl.VALIDATE_STATUS)){var s=gl.getProgramInfoLog(i);throw new Error("Could not validate shader program. \n\n"+s)}this.programId=i,this.uniformLocations=new Map,this.getUniformLocations()}return createClass(t,[{key:"getUniformLocations",value:function(){for(var t=gl.getProgramParameter(this.programId,gl.ACTIVE_UNIFORMS),e=0;e<t;e++){
var a=gl.getActiveUniform(this.programId,e);if(null===a)throw new Error("Couldn't get uniform info");var r=this.getUniformLocation(a.name);r&&this.uniformLocations.set(a.name,r)}}},{key:"getUniformLocation",value:function(t){return gl.getUniformLocation(this.programId,t)}},{key:"start",value:function(){gl.useProgram(this.programId)}},{key:"stop",value:function(){gl.useProgram(null)}},{key:"compileShader",value:function(t,e){var a=gl.createShader(e);if(gl.shaderSource(a,t),gl.compileShader(a),!gl.getShaderParameter(a,gl.COMPILE_STATUS))throw new Error("Couldn't compiler shader: "+gl.getShaderInfoLog(a));return a}},{key:"uniformFloat",value:function(t,e){if(!this.uniformLocations.has(t))throw new Error("Tried to set unknown uniform "+t);gl.uniform1fv(this.uniformLocations.get(t),[e])}},{key:"uniform2fv",value:function(t,e){if(!this.uniformLocations.has(t))throw new Error("Tried to set unknown uniform "+t);gl.uniform2fv(this.uniformLocations.get(t),e)}},{key:"uniform3fv",value:function(t,e){if(!this.uniformLocations.has(t))throw new Error("Tried to set unknown uniform "+t);gl.uniform3fv(this.uniformLocations.get(t),e)}},{key:"uniformMatrix4fv",value:function(t,e){if(!this.uniformLocations.has(t))throw new Error("Tried to set unknown uniform "+t);gl.uniformMatrix4fv(this.uniformLocations.get(t),!1,e)}}]),t}(),vertexShader="#version 300 es\nlayout(location = 0) in vec3 position;\nlayout(location = 1) in vec2 uv;\nuniform mat4 transform;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nuniform mat4 projection;\nuniform mat4 view;\nout vec2 texCoords;\nvoid main() {\n  gl_Position = projection * view * transform * vec4(position, 1.0);\n  texCoords = uv * uvScale + uvOffset;\n}\n",fragmentShader="#version 300 es\nprecision highp float;\nin vec2 texCoords;\nuniform sampler2D textureSampler;\nuniform float night;\nout vec4 color;\nvoid main() {\n  color = texture(textureSampler, texCoords);\n  vec4 nightColor = vec4(1.0 - color.r, 1.0 - color.g, 1.0 - color.b, color.a);\n  color = mix(color, nightColor, night);\n}\n",VIEW_HEIGHT=1.6,FOV=Math.PI/6,NEAR=.1,FAR=1e3,projection=mat4.create();mat4.perspective(projection,FOV,gl.drawingBufferWidth/gl.drawingBufferHeight,NEAR,FAR);var view=mat4.create();mat4.translate(view,view,[0,VIEW_HEIGHT,0]),mat4.invert(view,view);var vrDisplay=void 0,frameData=void 0;"getVRDisplays"in navigator&&(frameData=new VRFrameData,navigator.getVRDisplays().then(function(t){t.length>0&&(vrDisplay=t[0],vrDisplay.depthFar=FAR,vrDisplay.depthNear=NEAR)}));var SIDE;!function(t){t[t.LEFT=1]="LEFT",t[t.RIGHT=2]="RIGHT",t[t.BOTH=3]="BOTH"}(SIDE||(SIDE={}));var eyeView=mat4.create(),Renderer=function(){function t(){classCallCheck(this,t),this.shader=new ShaderProgram(vertexShader,fragmentShader),this.shader.start(),gl.enable(gl.BLEND),gl.blendFunc(gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA),gl.clearColor(.97,.97,.97,1)}return createClass(t,[{key:"requestVR",value:function(){vrDisplay&&!vrDisplay.isPresenting&&vrDisplay.requestPresent([{source:canvas}]).then(function(){var t=vrDisplay.getEyeParameters("left"),e=vrDisplay.getEyeParameters("right"),a=2*Math.max(t.renderWidth,e.renderWidth),r=Math.max(t.renderHeight,e.renderHeight);canvas.width=a,canvas.height=r})}},{key:"exitVR",value:function(){vrDisplay&&vrDisplay.isPresenting&&vrDisplay.exitPresent().then(function(){canvas.width=window.innerWidth,canvas.height=window.innerHeight})}},{key:"requestAnimationFrame",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){return vrDisplay?vrDisplay.requestAnimationFrame(t):requestAnimationFrame(t)})},{key:"render",value:function(t){if(gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT),vrDisplay){if(vrDisplay.getFrameData(frameData),vrDisplay.isPresenting){var e=vrDisplay.getEyeParameters("left"),a=vrDisplay.getEyeParameters("right"),r=2*Math.max(e.renderWidth,a.renderWidth),n=Math.max(e.renderHeight,a.renderHeight);canvas.width=r,canvas.height=n,mat4.mul(eyeView,frameData.leftViewMatrix,view),this.drawEye(t,eyeView,frameData.leftProjectionMatrix,SIDE.LEFT),mat4.mul(eyeView,frameData.rightViewMatrix,view),this.drawEye(t,eyeView,frameData.rightProjectionMatrix,SIDE.RIGHT)}else mat4.mul(eyeView,frameData.leftViewMatrix,view),this.drawEye(t,eyeView,projection,SIDE.BOTH);vrDisplay.submitFrame()}else this.drawEye(t,view,projection,SIDE.BOTH);gl.flush()}},{key:"drawEye",value:function(t,e,a,r){var n=gl.drawingBufferWidth,i=0;r!==SIDE.BOTH&&(n/=2),r===SIDE.RIGHT&&(i+=n),gl.viewport(i,0,n,gl.drawingBufferHeight);var o=void 0,s=void 0;this.shader.uniformMatrix4fv("projection",a),this.shader.uniformMatrix4fv("view",e);var l=!0,u=!1,c=void 0;try{for(var h,M=t[Symbol.iterator]();!(l=(h=M.next()).done);l=!0){var m=h.value;m.visible&&(m.geometry!==o&&(m.geometry.bind(),o=m.geometry),m.texture!==s&&(m.texture.bind(gl.TEXTURE0),s=m.texture),this.shader.uniformMatrix4fv("transform",m.getTransform()),this.shader.uniform2fv("uvOffset",m.uvOffset),this.shader.uniform2fv("uvScale",m.uvScale),gl.drawElements(gl.TRIANGLES,m.geometry.vertexCount,gl.UNSIGNED_SHORT,0))}}catch(t){u=!0,c=t}finally{try{!l&&M.return&&M.return()}finally{if(u)throw c}}}}]),t}(),_animFrames,SPRITE_MAP_WIDTH$3=1233,SPRITE_MAP_HEIGHT$3=68,config$3={DROP_VELOCITY:-5,GRAVITY:.6,HEIGHT:47,INIITAL_JUMP_VELOCITY:-10,INTRO_DURATION:1500,MAX_JUMP_HEIGHT:30,MIN_JUMP_HEIGHT:30,SPEED_DROP_COEFFICIENT:3,SPRITE_WIDTH:262,START_X_POS:50,WIDTH:44,WIDTH_DUCK:59,SPRITE_X:848,SPRITE_Y:2},DIST_UNITS=1/config$3.HEIGHT,collisionBoxes={DUCKING:[new CollisionBox(1,18,55,25)],RUNNING:[new CollisionBox(22,0,17,16),new CollisionBox(1,18,30,9),new CollisionBox(10,35,14,8),new CollisionBox(1,24,29,5),new CollisionBox(5,30,21,4),new CollisionBox(9,34,15,4)]},STATE;!function(t){t[t.CRASHED=0]="CRASHED",t[t.DUCKING=1]="DUCKING",t[t.JUMPING=2]="JUMPING",t[t.RUNNING=3]="RUNNING",t[t.WAITING=4]="WAITING"}(STATE||(STATE={}));var BLINK_TIMING=7e3,animFrames=(_animFrames={},defineProperty(_animFrames,STATE.WAITING,{frames:[44,0],msPerFrame:1e3/3}),defineProperty(_animFrames,STATE.RUNNING,{frames:[88,132],msPerFrame:1e3/12}),defineProperty(_animFrames,STATE.CRASHED,{frames:[220],msPerFrame:1e3/60}),defineProperty(_animFrames,STATE.JUMPING,{frames:[0],msPerFrame:1e3/60}),defineProperty(_animFrames,STATE.DUCKING,{frames:[264,323],msPerFrame:125}),_animFrames),Trex=function(t){function e(t){classCallCheck(this,e);var a=possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,quad,t));return a.currentFrame=0,a.currentAnimFrames=[0],a.blinkDelay=0,a.blinkCount=0,a.animStartTime=0,a.timer=0,a.msPerFrame=1e3,a.state=STATE.WAITING,a.jumping=!1,a.ducking=!1,a.jumpVelocity=0,a.reachedMinHeight=!1,a.speedDrop=!1,a.jumpCount=0,a.jumpspotX=0,a.init(),a}return inherits(e,t),createClass(e,[{key:"init",value:function(){this.setSpritePosition(SPRITE_MAP_WIDTH$3,SPRITE_MAP_HEIGHT$3,config$3.SPRITE_X,config$3.SPRITE_Y,config$3.WIDTH,config$3.HEIGHT),this.updateTexture(),this.update(0,STATE.WAITING)}},{key:"setJumpVelocity",value:function(t){config$3.INIITAL_JUMP_VELOCITY=-t,config$3.DROP_VELOCITY=-t/2}},{key:"update",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.timer+=t,null!==e&&(this.state=e,this.currentFrame=0,this.msPerFrame=animFrames[e].msPerFrame,this.currentAnimFrames=animFrames[e].frames,e==STATE.WAITING&&(this.animStartTime=getTimeStamp(),this.setBlinkDelay())),this.state==STATE.WAITING?this.blink(getTimeStamp()):this.updateTexture(),this.timer>=this.msPerFrame&&(this.currentFrame=this.currentFrame==this.currentAnimFrames.length-1?0:this.currentFrame+1,this.timer=0),this.speedDrop&&0===this.position[1]&&(this.speedDrop=!1,this.setDuck(!0))}},{key:"updateTexture",value:function(){var t=this.currentAnimFrames[this.currentFrame]+config$3.SPRITE_X,e=config$3.SPRITE_Y,a=this.ducking&&this.state!=STATE.CRASHED?config$3.WIDTH_DUCK:config$3.WIDTH,r=config$3.HEIGHT;this.setSpritePosition(SPRITE_MAP_WIDTH$3,SPRITE_MAP_HEIGHT$3,t,e,a,r)}},{key:"setBlinkDelay",value:function(){this.blinkDelay=Math.ceil(Math.random()*BLINK_TIMING)}},{key:"blink",value:function(t){var e=t-this.animStartTime;e>=this.blinkDelay&&(this.updateTexture(),1==this.currentFrame&&(this.setBlinkDelay(),this.animStartTime=t,this.blinkCount++))}},{key:"startJump",value:function(t){this.jumping||(this.update(0,STATE.JUMPING),this.jumpVelocity=config$3.INIITAL_JUMP_VELOCITY-t/10,this.jumping=!0,this.reachedMinHeight=!1,this.speedDrop=!1)}},{key:"endJump",value:function(){this.reachedMinHeight&&this.jumpVelocity<config$3.DROP_VELOCITY&&(this.jumpVelocity=config$3.DROP_VELOCITY)}},{key:"updateJump",value:function(t){var e=animFrames[this.state].msPerFrame,a=t/e,r=this.position[1]/DIST_UNITS;r-=this.speedDrop?Math.round(this.jumpVelocity*config$3.SPEED_DROP_COEFFICIENT*a):Math.round(this.jumpVelocity*a),this.jumpVelocity+=config$3.GRAVITY*a,(r>config$3.MIN_JUMP_HEIGHT||this.speedDrop)&&(this.reachedMinHeight=!0),(r>config$3.MAX_JUMP_HEIGHT||this.speedDrop)&&this.endJump(),r<0&&(this.reset(),this.jumpCount++),this.position[1]=r*DIST_UNITS,this.needsUpdate=!0,this.update(t)}},{key:"setSpeedDrop",value:function(){this.speedDrop=!0,this.jumpVelocity=1}},{key:"setDuck",value:function(t){t&&this.state!=STATE.DUCKING?(this.update(0,STATE.DUCKING),this.ducking=!0):this.state==STATE.DUCKING&&(this.update(0,STATE.RUNNING),this.ducking=!1)}},{key:"run",value:function(){this.update(0,STATE.RUNNING)}},{key:"setCrashed",value:function(){this.update(100,STATE.CRASHED)}},{key:"reset",value:function(){this.position[1]=0,this.jumpVelocity=0,this.jumping=!1,this.ducking=!1,this.update(0,STATE.RUNNING),this.speedDrop=!1,this.jumpCount=0}}]),e}(Model),config={ACCELERATION:.001,BG_CLOUD_SPEED:.2,BOTTOM_PAD:10,CLEAR_TIME:3e3,CLOUD_FREQUENCY:.5,GAMEOVER_CLEAR_TIME:750,INITIAL_JUMP_VELOCITY:12,INVERT_FADE_DURATION:12e3,INVERT_DISTANCE:700,MAX_BLINK_COUNT:3,MAX_CLOUDS:6,MAX_OBSTACLE_LENGTH:3,MAX_SPEED:13,MIN_JUMP_HEIGHT:35,MOBILE_SPEED_COEFFICIENT:1.2,RESOURCE_TEMPLATE_ID:"audio-resources",SPEED:6,SPEED_DROP_COEFFICIENT:3},imageSprite=document.getElementById("sprites"),classes={CANVAS:"runner-canvas",CONTAINER:"runner-container",CRASHED:"crashed",ICON:"icon-offline",INVERTED:"inverted",SNACKBAR:"snackbar",SNACKBAR_SHOW:"snackbar-show",TOUCH_CONTROLLER:"controller"},spriteDefinition={CLOUD:{x:86,y:2},HORIZON:{x:2,y:54},MOON:{x:484,y:2},RESTART:{x:2,y:2},TEXT_SPRITE:{x:655,y:2},TREX:{x:848,y:2},STAR:{x:645,y:2}},sounds={BUTTON_PRESS:"button-press",HIT:"hit",SCORE:"score-reached"},keycodes={JUMP:new Set([38,32]),DUCK:new Set([40]),RESTART:new Set([13]),VR:new Set([86])},events={ANIM_END:"webkitAnimationEnd",CLICK:"click",KEYDOWN:"keydown",KEYUP:"keyup",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",RESIZE:"resize",TOUCHEND:"touchend",TOUCHSTART:"touchstart",VISIBILITY:"visibilitychange",BLUR:"blur",FOCUS:"focus",LOAD:"load"},Runner=function(){function t(){if(classCallCheck(this,t),!imageSprite)throw new Error("Cannot construct Runner until images have loaded");this.renderer=new Renderer,this.spriteTexture=new Texture(imageSprite),this.distanceRan=0,this.highestScore=0,this.time=0,this.runningTime=0,this.msPerFrame=1e3/60,this.currentSpeed=config.SPEED,this.obstacles=[],this.playing=!1,this.crashed=!1,this.paused=!1,this.inverted=!1,this.invertTimer=0,this.soundFx={BUTTON_PRESS:null,HIT:null,SCORE:null},this.loadSounds(),this.audioContext=new AudioContext,this.gameOverPanel=new GameOverPanel(this.spriteTexture),this.gameOverPanel.visible=!1,this.gameOverPanel.position[2]=-4,this.gameOverPanel.position[1]=1.75,this.distanceMeter=new DistanceMeter(imageSprite,spriteDefinition.TEXT_SPRITE.x,spriteDefinition.TEXT_SPRITE.y),this.distanceMeter.position[2]=-4.3,this.distanceMeter.position[1]=1.6,this.tRex=new Trex(this.spriteTexture),this.tRex.position[0]=-.5,this.tRex.position[2]=-10,this.clouds=[],this.obstacles=[];for(var e=[Pterodactyl,SmallCactus],a=0;a<20;a++){this.clouds.push(new Cloud(this.spriteTexture)),this.clouds[a].euler[1]=a*Math.PI/10,this.clouds[a].position[2]=-20;var r=a%e.length;this.obstacles.push(new e[r](this.spriteTexture,this.currentSpeed)),this.obstacles[a].euler[1]=a*Math.PI/10,this.obstacles[a].position[2]=-10}IS_MOBILE&&this.createTouchController(),this.startListening(),this.update()}return createClass(t,[{key:"updateConfigSetting",value:function(t,e){}},{key:"loadSounds",value:function(){var t=this,e=function(e){var a=sounds[e];fetch("resources/"+a+".mp3").then(function(t){return t.arrayBuffer()}).then(function(e){return t.audioContext.decodeAudioData(e)}).then(function(a){return t.soundFx[e]=a})};for(var a in sounds)e(a)}},{key:"setSpeed",value:function(t){this.currentSpeed=t}},{key:"createTouchController",value:function(){this.touchController=document.createElement("div"),this.touchController.className=classes.TOUCH_CONTROLLER}},{key:"startGame",value:function(){var t=this;this.runningTime=0,document.addEventListener(events.VISIBILITY,function(e){return t.onVisibilityChange(e)}),window.addEventListener(events.BLUR,function(e){return t.onVisibilityChange(e)}),window.addEventListener(events.FOCUS,function(e){return t.onVisibilityChange(e)})}},{key:"update",value:function(){var t=getTimeStamp(),e=t-(this.time||t);if(this.time=t,this.playing){this.tRex.jumping&&this.tRex.updateJump(e),this.runningTime+=e;var a=(this.runningTime>config.CLEAR_TIME,!0),r=!1,n=void 0;try{for(var i,o=this.clouds[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var s=i.value;s.update(this.currentSpeed/1e4)}}catch(t){r=!0,n=t}finally{try{!a&&o.return&&o.return()}finally{if(r)throw n}}var l=!0,u=!1,c=void 0;try{for(var h,M=this.obstacles[Symbol.iterator]();!(l=(h=M.next()).done);l=!0){var m=h.value;m.update(e,this.currentSpeed/1e3)}}catch(t){u=!0,c=t}finally{try{!l&&M.return&&M.return()}finally{if(u)throw c}}var f=!1;f?this.gameOver():(this.distanceRan+=this.currentSpeed*e/this.msPerFrame,this.currentSpeed<config.MAX_SPEED&&(this.currentSpeed+=config.ACCELERATION));var S=this.distanceMeter.update(e,Math.ceil(this.distanceRan));S&&this.playSound("SCORE")}this.tRex.update(e),this.scheduleNextUpdate(),this.renderer.render([].concat(toConsumableArray(this.obstacles),toConsumableArray(this.clouds),[this.tRex,this.distanceMeter,this.gameOverPanel]))}},{key:"handleEvent",value:function(t){var e=t.type;switch(e){case events.KEYDOWN:case events.TOUCHSTART:case events.MOUSEDOWN:this.onKeyDown(t);break;case events.KEYUP:case events.TOUCHEND:case events.MOUSEUP:this.onKeyUp(t)}}},{key:"startListening",value:function(){document.addEventListener(events.KEYDOWN,this),document.addEventListener(events.KEYUP,this),IS_MOBILE?(this.touchController.addEventListener(events.TOUCHSTART,this,{passive:!0}),this.touchController.addEventListener(events.TOUCHEND,this),canvas.addEventListener(events.TOUCHSTART,this,{passive:!0})):(document.addEventListener(events.MOUSEDOWN,this),document.addEventListener(events.MOUSEUP,this))}},{key:"stopListening",value:function(){document.removeEventListener(events.KEYDOWN,this),document.removeEventListener(events.KEYUP,this),IS_MOBILE?(this.touchController.removeEventListener(events.TOUCHSTART,this),this.touchController.removeEventListener(events.TOUCHEND,this),canvas.removeEventListener(events.TOUCHSTART,this)):(document.removeEventListener(events.MOUSEDOWN,this),document.removeEventListener(events.MOUSEUP,this))}},{key:"onKeyDown",value:function(t){IS_MOBILE&&this.playing&&t.preventDefault(),this.crashed||!keycodes.JUMP.has(t.keyCode)&&t.type!=events.TOUCHSTART||(this.playing||(this.playing=!0,this.update()),this.tRex.jumping||this.tRex.ducking||(this.playSound("BUTTON_PRESS"),this.tRex.startJump(this.currentSpeed))),this.crashed&&t.type==events.TOUCHSTART&&t.currentTarget==canvas&&this.restart(),this.playing&&!this.crashed&&keycodes.DUCK.has(t.keyCode)&&(t.preventDefault(),this.tRex.jumping?this.tRex.setSpeedDrop():this.tRex.jumping||this.tRex.ducking||this.tRex.setDuck(!0))}},{key:"onKeyUp",value:function(t){var e=keycodes.JUMP.has(t.keyCode)||t.type==events.TOUCHEND||t.type==events.MOUSEDOWN;if(keycodes.VR.has(t.keyCode))this.renderer.requestVR();else if(this.isRunning()&&e)this.tRex.endJump();else if(keycodes.DUCK.has(t.keyCode))this.tRex.speedDrop=!1,this.tRex.setDuck(!1);else if(this.crashed){var a=getTimeStamp()-this.time;(keycodes.RESTART.has(t.keyCode)||this.isLeftClickOnCanvas(t)||a>=config.GAMEOVER_CLEAR_TIME&&keycodes.JUMP.has(t.keyCode))&&this.restart()}else this.paused&&e&&(this.tRex.reset(),this.play())}},{key:"isLeftClickOnCanvas",value:function(t){return null!=t.button&&t.button<2&&t.type==events.MOUSEUP&&t.target==canvas}},{key:"scheduleNextUpdate",value:function(){var t=this;this.rafId||(this.rafId=this.renderer.requestAnimationFrame(function(){t.rafId=0,t.update()}))}},{key:"isRunning",value:function(){return!!this.rafId}},{key:"gameOver",value:function(){this.playSound("HIT"),vibrate(200),this.stop(),this.crashed=!0,this.tRex.setCrashed(),this.gameOverPanel.visible=!0,this.distanceRan>this.highestScore&&(this.highestScore=Math.ceil(this.distanceRan),this.distanceMeter.setHighScore(this.highestScore)),this.time=getTimeStamp()}},{key:"stop",value:function(){this.playing=!1,this.paused=!0,cancelAnimationFrame(this.rafId),this.rafId=0}},{key:"play",value:function(){this.crashed||(this.playing=!0,this.paused=!1,this.tRex.run(),this.time=getTimeStamp(),this.update())}},{key:"restart",value:function(){this.runningTime=0,this.playing=!0,this.crashed=!1,this.distanceRan=0,this.setSpeed(config.SPEED),this.time=getTimeStamp(),this.distanceMeter.reset(),this.gameOverPanel.visible=!1,this.tRex.reset(),this.playSound("BUTTON_PRESS"),this.invert(!0),this.update()}},{key:"onVisibilityChange",value:function(t){document.hidden||document.webkitHidden||"blur"==t.type||"visible"!=document.visibilityState?this.stop():this.crashed||(this.tRex.reset(),this.play())}},{key:"playSound",value:function(t){if(this.soundFx[t]){var e=this.soundFx[t],a=this.audioContext.createBufferSource();a.buffer=e,a.connect(this.audioContext.destination),a.start(0)}}},{key:"invert",value:function(t){}}]),t}(),getRunner=function(){return imageSprite?imageSprite.complete?Promise.resolve(new Runner):new Promise(function(t){imageSprite.addEventListener(events.LOAD,function(){t(new Runner)})}):Promise.reject("Spritesheet not found")};"serviceWorker"in navigator&&navigator.serviceWorker.register("sw.js"),getRunner().then(function(t){console.log(t)});
